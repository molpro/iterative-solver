<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iterative-solver: /__w/iterative-solver/iterative-solver/src/molpro/linalg/array/ArrayHandler.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iterative-solver<span id="projectnumber">&#160;0.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ArrayHandler_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">ArrayHandler.h</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#ifndef LINEARALGEBRA_SRC_MOLPRO_LINALG_ARRAY_ARRAYHANDLER_H</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#define LINEARALGEBRA_SRC_MOLPRO_LINALG_ARRAY_ARRAYHANDLER_H</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;numeric&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;set&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;stdexcept&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;molpro/linalg/array/type_traits.h&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;molpro/linalg/itsolv/subspace/Matrix.h&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;molpro/linalg/itsolv/wrap_util.h&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="keyword">using </span><a class="code hl_typedef" href="namespacemolpro_1_1linalg_1_1itsolv.html#aafd1821a97ea122d56be347e38e90a89">molpro::linalg::itsolv::CVecRef</a>;</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="keyword">using </span><a class="code hl_typedef" href="namespacemolpro_1_1linalg_1_1itsolv.html#ab44c7c7dfce88d39d260d1f5c7b70fab">molpro::linalg::itsolv::VecRef</a>;</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="keyword">using </span><a class="code hl_class" href="classmolpro_1_1linalg_1_1itsolv_1_1subspace_1_1Matrix.html">molpro::linalg::itsolv::subspace::Matrix</a>;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="namespacemolpro_1_1linalg_1_1array.html">   22</a></span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacemolpro_1_1linalg_1_1array.html">molpro::linalg::array</a> {</div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="namespacemolpro_1_1linalg_1_1array_1_1util.html">   23</a></span><span class="keyword">namespace </span>util {</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1ArrayHandlerError.html">   25</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1ArrayHandlerError.html">ArrayHandlerError</a> : <span class="keyword">public</span> std::logic_error {</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>  <span class="keyword">using </span>std::logic_error::logic_error;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>};</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html">   32</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html">OperationRegister</a> {</div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#adec453c471eab2cf48d7c8c43a9e31c2">   33</a></span>  <span class="keyword">using </span><a class="code hl_typedef" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#adec453c471eab2cf48d7c8c43a9e31c2">OP</a> = std::tuple&lt;Args...&gt;;</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">   34</a></span>  std::list&lt;std::tuple&lt;Args...&gt;&gt; <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>; </div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> N, <span class="keyword">class</span> ArgEqual&gt;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a85d5441e4a6d527c6672878ab2dad9f1">   41</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a85d5441e4a6d527c6672878ab2dad9f1">push</a>(<span class="keyword">const</span> Args &amp;...args, ArgEqual equal) {</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <span class="keyword">auto</span> &amp;&amp;new_op = <a class="code hl_typedef" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#adec453c471eab2cf48d7c8c43a9e31c2">OP</a>{args...};</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="keyword">auto</span> &amp;ref = std::get&lt;N&gt;(new_op);</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="keyword">auto</span> rend = std::find_if(<a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>.rbegin(), <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>.rend(), [&amp;ref, &amp;equal](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;el) {</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>      auto xx = std::get&lt;N&gt;(el);</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>      return equal(ref, xx);</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    });</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <span class="keyword">auto</span> end_of_group = <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>.end();</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <span class="keywordflow">if</span> (rend != <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>.rend())</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>      end_of_group = rend.base();</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>.insert(end_of_group, std::forward&lt;OP&gt;(new_op));</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>  }</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#adf738d84096126b2c6442399eafebd8a">   55</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#adf738d84096126b2c6442399eafebd8a">push</a>(<span class="keyword">const</span> Args &amp;...args) { <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>.push_back({args...}); }</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#aa0c23529a797aa3a5f2c0b2926cba03f">   57</a></span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#aa0c23529a797aa3a5f2c0b2926cba03f">empty</a>() { <span class="keywordflow">return</span> <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>.empty(); }</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a91d2643100e88fafe2a373d4ba66f9b9">   58</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a91d2643100e88fafe2a373d4ba66f9b9">clear</a>() { <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>.clear(); }</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>};</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> X, <span class="keyword">typename</span> Y, <span class="keyword">typename</span> Z, <span class="keyword">class</span> EqualX, <span class="keyword">class</span> EqualY, <span class="keyword">class</span> EqualZ&gt;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>std::tuple&lt;std::vector&lt;std::tuple&lt;size_t, size_t, size_t&gt;&gt;, std::vector&lt;X&gt;, std::vector&lt;Y&gt;, std::vector&lt;Z&gt;&gt;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno"><a class="line" href="namespacemolpro_1_1linalg_1_1array_1_1util.html#a922d235e8c5336c4ef99bd5f966bb896">   74</a></span><a class="code hl_function" href="namespacemolpro_1_1linalg_1_1array_1_1util.html#a922d235e8c5336c4ef99bd5f966bb896">remove_duplicates</a>(<span class="keyword">const</span> std::list&lt;std::tuple&lt;X, Y, Z&gt;&gt; &amp;reg, EqualX equal_x, EqualY equal_y, EqualZ equal_z) {</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>  <span class="keyword">auto</span> n_op = reg.size();</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>  std::vector&lt;std::tuple&lt;size_t, size_t, size_t&gt;&gt; op_register;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>  op_register.reserve(n_op);</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  std::vector&lt;X&gt; xx;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  std::vector&lt;Y&gt; yy;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  std::vector&lt;Z&gt; zz;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;op : reg) {</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="keyword">auto</span> x = std::get&lt;0&gt;(op);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="keyword">auto</span> y = std::get&lt;1&gt;(op);</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keyword">auto</span> z = std::get&lt;2&gt;(op);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="keyword">auto</span> it_x = std::find_if(cbegin(xx), cend(xx), [&amp;x, &amp;equal_x](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;el) { <span class="keywordflow">return</span> equal_x(x, el); });</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="keyword">auto</span> it_y = std::find_if(cbegin(yy), cend(yy), [&amp;y, &amp;equal_y](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;el) { <span class="keywordflow">return</span> equal_y(y, el); });</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="keyword">auto</span> it_z = std::find_if(cbegin(zz), cend(zz), [&amp;z, &amp;equal_z](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;el) { <span class="keywordflow">return</span> equal_z(z, el); });</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="keyword">auto</span> ix = distance(cbegin(xx), it_x);</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    <span class="keyword">auto</span> iy = distance(cbegin(yy), it_y);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <span class="keyword">auto</span> iz = distance(cbegin(zz), it_z);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keywordflow">if</span> (it_x == cend(xx))</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>      xx.push_back(x);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    <span class="keywordflow">if</span> (it_y == cend(yy))</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>      yy.push_back(y);</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    <span class="keywordflow">if</span> (it_z == cend(zz))</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>      zz.push_back(z);</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    op_register.emplace_back(ix, iy, iz);</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>  }</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>  <span class="keywordflow">return</span> {op_register, xx, yy, zz};</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>}</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T = <span class="keywordtype">int</span>&gt;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html">  104</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html">RefEqual</a> {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html#a1d71d8c5238f6cddb1a15db36ecbb882">  105</a></span>  <span class="keywordtype">bool</span> <a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html#a1d71d8c5238f6cddb1a15db36ecbb882">operator()</a>(<span class="keyword">const</span> std::reference_wrapper&lt;T&gt; &amp;l, <span class="keyword">const</span> std::reference_wrapper&lt;T&gt; &amp;r) {</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    <span class="keywordflow">return</span> std::addressof(l.get()) == std::addressof(r.get());</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>  }</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>};</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>} <span class="comment">// namespace util</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span><span class="keyword">template</span> &lt;<span class="keyword">class</span> AL, <span class="keyword">class</span> AR = AL&gt;</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html">  162</a></span><span class="keyword">class </span><a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html">ArrayHandler</a> {</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span><span class="keyword">protected</span>:</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#aab00b2597df72f3989554c25f8a55bdb">  164</a></span>  <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#aab00b2597df72f3989554c25f8a55bdb">ArrayHandler</a>() : <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>(std::make_unique&lt;<a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html">Counter</a>&gt;()){};</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a5e709cde75bb14f82ddddfb63d7d4e7e">  165</a></span>  <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a5e709cde75bb14f82ddddfb63d7d4e7e">ArrayHandler</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html">ArrayHandler</a> &amp;) = <span class="keywordflow">default</span>;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html">  167</a></span>  <span class="keyword">struct </span><a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html">Counter</a> {</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a9d520e242d7fcaaa775768eaf9a834dc">  168</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a9d520e242d7fcaaa775768eaf9a834dc">scal</a> = 0;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a5ad2b6f45fd33ca55ec7c1b110f2066e">  169</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a5ad2b6f45fd33ca55ec7c1b110f2066e">dot</a> = 0;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a79929e52bd35c9046eb3e9dca6f2b71f">  170</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a79929e52bd35c9046eb3e9dca6f2b71f">axpy</a> = 0;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a6241ac3f1e9f88d16def846e3d5ed5f4">  171</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a6241ac3f1e9f88d16def846e3d5ed5f4">copy</a> = 0;</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a5cbd61f446c2aaf730f319376be95331">  172</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a5cbd61f446c2aaf730f319376be95331">gemm_inner</a> = 0;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno"><a class="line" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a81a28a4bc061af75fec23768979e1bc2">  173</a></span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a81a28a4bc061af75fec23768979e1bc2">gemm_outer</a> = 0;</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  };</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">  176</a></span>  std::unique_ptr&lt;Counter&gt; <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a421d6107b2a60ffcdfb79d2d27c30c73">  179</a></span>  <span class="keyword">using </span><a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a421d6107b2a60ffcdfb79d2d27c30c73">value_type_L</a> = <span class="keyword">typename</span> <a class="code hl_typedef" href="namespacemolpro_1_1linalg_1_1array.html#a5aeb80119c6ea1e4cd9155b6fb025344">array::mapped_or_value_type_t&lt;AL&gt;</a>;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a1750335b1260644a4dd836929ba1e2bf">  180</a></span>  <span class="keyword">using </span><a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a1750335b1260644a4dd836929ba1e2bf">value_type_R</a> = <span class="keyword">typename</span> <a class="code hl_typedef" href="namespacemolpro_1_1linalg_1_1array.html#a5aeb80119c6ea1e4cd9155b6fb025344">array::mapped_or_value_type_t&lt;AR&gt;</a>;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a439d2213a07466b54e366f4fa45b02de">  181</a></span>  <span class="keyword">using </span><a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a439d2213a07466b54e366f4fa45b02de">value_type</a> = <span class="keyword">decltype</span>(<a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a421d6107b2a60ffcdfb79d2d27c30c73">value_type_L</a>{} * <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a1750335b1260644a4dd836929ba1e2bf">value_type_R</a>{});</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#abb16bb06ec4dfd2118e55f64087a204e">  182</a></span>  <span class="keyword">using </span><a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#abb16bb06ec4dfd2118e55f64087a204e">value_type_abs</a> = <span class="keyword">decltype</span>(check_abs&lt;value_type&gt;());</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a4e3e408ae09aaf1a463257dec668cb1f">  184</a></span>  <span class="keyword">virtual</span> AL <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a4e3e408ae09aaf1a463257dec668cb1f">copy</a>(<span class="keyword">const</span> AR &amp;source) = 0;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a6788b6924c2e9565d4cbac8e6c84109f">  186</a></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a6788b6924c2e9565d4cbac8e6c84109f">copy</a>(AL &amp;x, <span class="keyword">const</span> AR &amp;y) = 0;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a2d055c67fa2b7087b03ada96877b842c">  187</a></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a2d055c67fa2b7087b03ada96877b842c">scal</a>(<a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a439d2213a07466b54e366f4fa45b02de">value_type</a> alpha, AL &amp;x) = 0;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8c8021df8b9b0c3c449781783eb8a242">  188</a></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8c8021df8b9b0c3c449781783eb8a242">fill</a>(<a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a439d2213a07466b54e366f4fa45b02de">value_type</a> alpha, AL &amp;x) = 0;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a6e145dd6a76d8ddea588f2104a9c140e">  189</a></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a6e145dd6a76d8ddea588f2104a9c140e">axpy</a>(<a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a439d2213a07466b54e366f4fa45b02de">value_type</a> alpha, <span class="keyword">const</span> AR &amp;x, AL &amp;y) = 0;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a05ed79049a10cf88164895aa2da8c6c6">  190</a></span>  <span class="keyword">virtual</span> <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a439d2213a07466b54e366f4fa45b02de">value_type</a> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a05ed79049a10cf88164895aa2da8c6c6">dot</a>(<span class="keyword">const</span> AL &amp;x, <span class="keyword">const</span> AR &amp;y) = 0;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a425ca68c78689a5eba39acdba92f364c">  195</a></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a425ca68c78689a5eba39acdba92f364c">gemm_outer</a>(<span class="keyword">const</span> <a class="code hl_class" href="classmolpro_1_1linalg_1_1itsolv_1_1subspace_1_1Matrix.html">Matrix&lt;value_type&gt;</a> alphas, <span class="keyword">const</span> CVecRef&lt;AR&gt; &amp;xx, <span class="keyword">const</span> VecRef&lt;AL&gt; &amp;yy) = 0;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8882095af0c40a0f6c678fec6f051391">  200</a></span>  <span class="keyword">virtual</span> <a class="code hl_class" href="classmolpro_1_1linalg_1_1itsolv_1_1subspace_1_1Matrix.html">Matrix&lt;value_type&gt;</a> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8882095af0c40a0f6c678fec6f051391">gemm_inner</a>(<span class="keyword">const</span> CVecRef&lt;AL&gt; &amp;xx, <span class="keyword">const</span> CVecRef&lt;AR&gt; &amp;yy) = 0;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a961a362008722b7118640c95eb5189ac">  212</a></span>  <span class="keyword">virtual</span> std::map&lt;size_t, value_type_abs&gt; <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a961a362008722b7118640c95eb5189ac">select_max_dot</a>(<span class="keywordtype">size_t</span> n, <span class="keyword">const</span> AL &amp;x, <span class="keyword">const</span> AR &amp;y) = 0;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a0cd8a03ec5ff22776cb80dacf55c0552">  222</a></span>  <span class="keyword">virtual</span> std::map&lt;size_t, value_type&gt; <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a0cd8a03ec5ff22776cb80dacf55c0552">select</a>(<span class="keywordtype">size_t</span> n, <span class="keyword">const</span> AL &amp;x, <span class="keywordtype">bool</span> max = <span class="keyword">false</span>, <span class="keywordtype">bool</span> ignore_sign = <span class="keyword">false</span>) = 0;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span> </div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#abe05067f4eb67264edaef960015a9423">  224</a></span>  <span class="keyword">const</span> <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html">Counter</a> &amp;<a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#abe05067f4eb67264edaef960015a9423">counter</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>; }</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#aaeef8109bd1d949e8f413a399c0c29be">  226</a></span>  std::string <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#aaeef8109bd1d949e8f413a399c0c29be">counter_to_string</a>(std::string L, std::string R) {</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    std::string output = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;scal &gt; 0)</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>      output.append(std::to_string(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;scal) + <span class="stringliteral">&quot; scaling operations of the &quot;</span> + L + <span class="stringliteral">&quot; vectors, &quot;</span>);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;copy &gt; 0)</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>      output.append(std::to_string(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;copy) + <span class="stringliteral">&quot; &quot;</span> + L + <span class="stringliteral">&quot;&lt;-&quot;</span> + R + <span class="stringliteral">&quot; copy operations, &quot;</span>);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;dot &gt; 0)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>      output.append(std::to_string(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;dot) + <span class="stringliteral">&quot; dot product operations between the &quot;</span> + L + <span class="stringliteral">&quot; and &quot;</span> + R +</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>                    <span class="stringliteral">&quot; vectors, &quot;</span>);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;axpy &gt; 0)</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>      output.append(std::to_string(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;axpy) + <span class="stringliteral">&quot; axpy (&quot;</span> + R + <span class="stringliteral">&quot; = a*&quot;</span> + L + <span class="stringliteral">&quot; + &quot;</span> + R + <span class="stringliteral">&quot;) operations, &quot;</span>);</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;gemm_inner &gt; 0)</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>      output.append(std::to_string(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;gemm_inner) + <span class="stringliteral">&quot; gemm_inner operations between the &quot;</span> + L + <span class="stringliteral">&quot; and &quot;</span> + R +</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                    <span class="stringliteral">&quot; vectors, &quot;</span>);</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;gemm_outer &gt; 0)</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>      output.append(std::to_string(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;gemm_outer) + <span class="stringliteral">&quot; gemm_outer operations between the &quot;</span> + L + <span class="stringliteral">&quot; and &quot;</span> + R +</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>                    <span class="stringliteral">&quot; vectors, &quot;</span>);</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    <span class="keywordflow">return</span> output;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>  };</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span> </div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#af6e2096242aea7daef3d8f0c1ee8df06">  246</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#af6e2096242aea7daef3d8f0c1ee8df06">clear_counter</a>() {</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;scal = 0;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;copy = 0;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;dot = 0;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;axpy = 0;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;gemm_inner = 0;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">m_counter</a>-&gt;gemm_outer = 0;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  }</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a9adcb3b8f3875d8706e792a0e09d5780">  256</a></span>  <span class="keyword">virtual</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a9adcb3b8f3875d8706e792a0e09d5780">~ArrayHandler</a>() {</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>    std::for_each(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">m_lazy_handles</a>.begin(), <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">m_lazy_handles</a>.end(), [](<span class="keyword">auto</span> &amp;el) {</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>      if (auto handle = el.lock())</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        handle-&gt;invalidate();</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    });</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>  }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="keyword">protected</span>:</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#ad70d4a3f485411537313606452fb75e6">  268</a></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#ad70d4a3f485411537313606452fb75e6">error</a>(<span class="keyword">const</span> std::string &amp;message) { <span class="keywordflow">throw</span> <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1ArrayHandlerError.html">util::ArrayHandlerError</a>{message}; };</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8d3ebad34f0f0b94a12816e50c7f3ee6">  271</a></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8d3ebad34f0f0b94a12816e50c7f3ee6">fused_axpy</a>(<span class="keyword">const</span> std::vector&lt;std::tuple&lt;size_t, size_t, size_t&gt;&gt; &amp;reg,</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>                          <span class="keyword">const</span> std::vector&lt;value_type&gt; &amp;alphas,</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>                          <span class="keyword">const</span> std::vector&lt;std::reference_wrapper&lt;const AR&gt;&gt; &amp;xx,</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>                          std::vector&lt;std::reference_wrapper&lt;AL&gt;&gt; &amp;yy) {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;i : reg) {</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      <span class="keywordtype">size_t</span> ai, xi, yi;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>      std::tie(ai, xi, yi) = i;</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>      <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a6e145dd6a76d8ddea588f2104a9c140e">axpy</a>(alphas[ai], xx[xi].get(), yy[yi].get());</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>  }</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a0cd5e391cf70fa6cf09acc8f72a55830">  283</a></span>  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a0cd5e391cf70fa6cf09acc8f72a55830">fused_dot</a>(<span class="keyword">const</span> std::vector&lt;std::tuple&lt;size_t, size_t, size_t&gt;&gt; &amp;reg,</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>                         <span class="keyword">const</span> std::vector&lt;std::reference_wrapper&lt;const AL&gt;&gt; &amp;xx,</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                         <span class="keyword">const</span> std::vector&lt;std::reference_wrapper&lt;const AR&gt;&gt; &amp;yy,</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>                         std::vector&lt;std::reference_wrapper&lt;value_type&gt;&gt; &amp;out) {</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;i : reg) {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>      <span class="keywordtype">size_t</span> xi, yi, zi;</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>      std::tie(xi, yi, zi) = i;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>      out[zi].get() = <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a05ed79049a10cf88164895aa2da8c6c6">dot</a>(xx[xi].get(), yy[yi].get());</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    }</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>  }</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html">  298</a></span>  <span class="keyword">class </span><a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html">LazyHandle</a> {</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a6a3cffeecdcf7f3136b6a27849936268">  300</a></span>    <span class="keyword">using </span><a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a6a3cffeecdcf7f3136b6a27849936268">value_type</a> = <a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html">ArrayHandler&lt;AL, AR&gt;::value_type</a>;</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">  302</a></span>    <span class="keyword">using </span><a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">ref_wrap</a> = std::reference_wrapper&lt;T&gt;;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>  <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad836493ce12da6c4bd02d927aaaff5d7">  306</a></span>    std::set&lt;std::string&gt; <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad836493ce12da6c4bd02d927aaaff5d7">m_op_types</a>;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adaa97da1577894bcbae46700767188d9">  308</a></span>    <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html">util::OperationRegister&lt;value_type, ref_wrap&lt;const AR&gt;</a>, <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">ref_wrap&lt;AL&gt;</a>&gt; <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adaa97da1577894bcbae46700767188d9">m_axpy</a>;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a45f59e92dce6d9b68af12131b82b4dc8">  310</a></span>    <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html">util::OperationRegister&lt;ref_wrap&lt;const AL&gt;</a>, <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">ref_wrap&lt;const AR&gt;</a>, <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">ref_wrap&lt;value_type&gt;</a>&gt; <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a45f59e92dce6d9b68af12131b82b4dc8">m_dot</a>;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a37d2271aef475029d8ee6dbfbec32be8">  312</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a37d2271aef475029d8ee6dbfbec32be8">error</a>(std::string message) { <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ac1d6fbcbcac61819fbf795dbfef5aeb8">m_handler</a>.<a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#ad70d4a3f485411537313606452fb75e6">error</a>(message); };</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#af477f947fe6c798ef3d964aae63582e6">  322</a></span>    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#af477f947fe6c798ef3d964aae63582e6">register_op_type</a>(<span class="keyword">const</span> std::string &amp;type) {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad836493ce12da6c4bd02d927aaaff5d7">m_op_types</a>.count(type) == 0 &amp;&amp; !<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad836493ce12da6c4bd02d927aaaff5d7">m_op_types</a>.empty())</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>      <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad836493ce12da6c4bd02d927aaaff5d7">m_op_types</a>.insert(type);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a0f15d7a19a377c8460a142f68fea2e79">  330</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a0f15d7a19a377c8460a142f68fea2e79">clear</a>() {</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>      <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad836493ce12da6c4bd02d927aaaff5d7">m_op_types</a>.clear();</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>      <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adaa97da1577894bcbae46700767188d9">m_axpy</a>.<a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a91d2643100e88fafe2a373d4ba66f9b9">clear</a>();</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>      <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a45f59e92dce6d9b68af12131b82b4dc8">m_dot</a>.<a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a91d2643100e88fafe2a373d4ba66f9b9">clear</a>();</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    }</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a648de93bf4d1802ca4aabbbf0abff761">  337</a></span>    <span class="keyword">explicit</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a648de93bf4d1802ca4aabbbf0abff761">LazyHandle</a>(<a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html">ArrayHandler&lt;AL, AR&gt;</a> &amp;handler) : <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ac1d6fbcbcac61819fbf795dbfef5aeb8">m_handler</a>{handler} {}</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a23a0db1962c8e9f0217ace8b384a9d1a">  338</a></span>    <span class="keyword">virtual</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a23a0db1962c8e9f0217ace8b384a9d1a">~LazyHandle</a>() { <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a0ccd48ee6a0c2d874ee5fe395f188f1c">LazyHandle::eval</a>(); }</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a080b8c891ee0a335943d4dabdea0c72b">  340</a></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a080b8c891ee0a335943d4dabdea0c72b">axpy</a>(<a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a6a3cffeecdcf7f3136b6a27849936268">value_type</a> alpha, <span class="keyword">const</span> AR &amp;x, AL &amp;y) {</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#af477f947fe6c798ef3d964aae63582e6">register_op_type</a>(<span class="stringliteral">&quot;axpy&quot;</span>))</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adaa97da1577894bcbae46700767188d9">m_axpy</a>.<a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a85d5441e4a6d527c6672878ab2dad9f1">push</a>(alpha, std::cref(x), std::ref(y));</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a37d2271aef475029d8ee6dbfbec32be8">error</a>(<span class="stringliteral">&quot;Failed to register operation type axpy with the current state of the LazyHandle&quot;</span>);</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    }</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a20dbb482f7200a82cc0212b595000d17">  346</a></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a20dbb482f7200a82cc0212b595000d17">dot</a>(<span class="keyword">const</span> AL &amp;x, <span class="keyword">const</span> AR &amp;y, <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a6a3cffeecdcf7f3136b6a27849936268">value_type</a> &amp;out) {</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#af477f947fe6c798ef3d964aae63582e6">register_op_type</a>(<span class="stringliteral">&quot;dotLR&quot;</span>))</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a45f59e92dce6d9b68af12131b82b4dc8">m_dot</a>.<a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a85d5441e4a6d527c6672878ab2dad9f1">push</a>(std::cref(x), std::cref(y), std::ref(out));</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>        <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a37d2271aef475029d8ee6dbfbec32be8">error</a>(<span class="stringliteral">&quot;Failed to register operation type dot with the current state of the LazyHandle&quot;</span>);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    }</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a0ccd48ee6a0c2d874ee5fe395f188f1c">  354</a></span>    <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a0ccd48ee6a0c2d874ee5fe395f188f1c">eval</a>() {</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad8f638facc5830ee0ccfe381c189da34">m_invalid</a>)</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adaa97da1577894bcbae46700767188d9">m_axpy</a>.<a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#aa0c23529a797aa3a5f2c0b2926cba03f">empty</a>()) {</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>        <span class="keyword">auto</span> reg = util::remove_duplicates&lt;value_type, ref_wrap&lt;const AR&gt;, <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">ref_wrap&lt;AL&gt;</a>, std::equal_to&lt;value_type&gt;,</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                                           <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html">util::RefEqual&lt;const AR&gt;</a>, <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html">util::RefEqual&lt;AL&gt;</a>&gt;(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adaa97da1577894bcbae46700767188d9">m_axpy</a>.<a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>, {}, {}, {});</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ac1d6fbcbcac61819fbf795dbfef5aeb8">m_handler</a>.<a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8d3ebad34f0f0b94a12816e50c7f3ee6">fused_axpy</a>(std::get&lt;0&gt;(reg), std::get&lt;1&gt;(reg), std::get&lt;2&gt;(reg), std::get&lt;3&gt;(reg));</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>      }</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a45f59e92dce6d9b68af12131b82b4dc8">m_dot</a>.<a class="code hl_function" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#aa0c23529a797aa3a5f2c0b2926cba03f">empty</a>()) {</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        <span class="keyword">auto</span> reg =</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>            util::remove_duplicates&lt;ref_wrap&lt;const AL&gt;, <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">ref_wrap&lt;const AR&gt;</a>, <a class="code hl_typedef" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">ref_wrap&lt;value_type&gt;</a>,</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>                                    <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html">util::RefEqual&lt;const AL&gt;</a>, <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html">util::RefEqual&lt;const AR&gt;</a>, <a class="code hl_struct" href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html">util::RefEqual&lt;value_type&gt;</a>&gt;(</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>                <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a45f59e92dce6d9b68af12131b82b4dc8">m_dot</a>.<a class="code hl_variable" href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">m_register</a>, {}, {}, {});</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ac1d6fbcbcac61819fbf795dbfef5aeb8">m_handler</a>.<a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a0cd5e391cf70fa6cf09acc8f72a55830">fused_dot</a>(std::get&lt;0&gt;(reg), std::get&lt;1&gt;(reg), std::get&lt;2&gt;(reg), std::get&lt;3&gt;(reg));</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>      }</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>      <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a0f15d7a19a377c8460a142f68fea2e79">clear</a>();</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    }</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a3b0ae2897bbda5ae8b074fa06e762b0e">  373</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a3b0ae2897bbda5ae8b074fa06e762b0e">invalidate</a>() { <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad8f638facc5830ee0ccfe381c189da34">m_invalid</a> = <span class="keyword">true</span>; }</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adc2f8a1d13761b128c1e1ed6adc08ba2">  376</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adc2f8a1d13761b128c1e1ed6adc08ba2">invalid</a>() { <span class="keywordflow">return</span> <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad8f638facc5830ee0ccfe381c189da34">m_invalid</a>; }</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span> </div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>  <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ac1d6fbcbcac61819fbf795dbfef5aeb8">  379</a></span>    <a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html">ArrayHandler&lt;AL, AR&gt;</a> &amp;<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ac1d6fbcbcac61819fbf795dbfef5aeb8">m_handler</a>; </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad8f638facc5830ee0ccfe381c189da34">  380</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad8f638facc5830ee0ccfe381c189da34">m_invalid</a> = <span class="keyword">false</span>;          </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  };</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span> </div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html">  384</a></span>  <span class="keyword">class </span><a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html">ProxyHandle</a> {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  <span class="keyword">public</span>:</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a1fe711bb00bfc533ec16b1f663d4b124">  386</a></span>    <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a1fe711bb00bfc533ec16b1f663d4b124">ProxyHandle</a>(std::shared_ptr&lt;LazyHandle&gt; handle) : <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">m_lazy_handle</a>{std::move(handle)} {}</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a5daab75b9b2b8173e8787a734f5b521b">  389</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a5daab75b9b2b8173e8787a734f5b521b">axpy</a>(Args &amp;&amp;...args) {</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">m_lazy_handle</a>-&gt;axpy(std::forward&lt;Args&gt;(args)...);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a9afd8b7fefd3a00507666f8197c0f934">m_off</a>)</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>        <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a3fbc8e8cf5973a81ee0dfff9f32aff74">eval</a>();</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    }</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span>... Args&gt;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#aa9281d9e60eeb5151eebf30fc3065b14">  395</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#aa9281d9e60eeb5151eebf30fc3065b14">dot</a>(Args &amp;&amp;...args) {</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>      <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">m_lazy_handle</a>-&gt;dot(std::forward&lt;Args&gt;(args)...);</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a9afd8b7fefd3a00507666f8197c0f934">m_off</a>)</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>        <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a3fbc8e8cf5973a81ee0dfff9f32aff74">eval</a>();</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    }</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a3fbc8e8cf5973a81ee0dfff9f32aff74">  400</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a3fbc8e8cf5973a81ee0dfff9f32aff74">eval</a>() { <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">m_lazy_handle</a>-&gt;eval(); }</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a7666eaa8bcf4a9a1997e1f86dc76a24e">  401</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a7666eaa8bcf4a9a1997e1f86dc76a24e">invalidate</a>() { <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">m_lazy_handle</a>-&gt;invalidate(); }</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a94ae88f7320b91c880474a5ecae16d94">  402</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a94ae88f7320b91c880474a5ecae16d94">invalid</a>() { <span class="keywordflow">return</span> <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">m_lazy_handle</a>-&gt;invalid(); }</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#ad0091fda4de382bbbe70a45e97a9e4a5">  405</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#ad0091fda4de382bbbe70a45e97a9e4a5">off</a>() { <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a9afd8b7fefd3a00507666f8197c0f934">m_off</a> = <span class="keyword">true</span>; };</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#ac075222a6329f35419e439a2ccadf36c">  407</a></span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#ac075222a6329f35419e439a2ccadf36c">on</a>() { <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a9afd8b7fefd3a00507666f8197c0f934">m_off</a> = <span class="keyword">false</span>; };</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a00385a3163d3f2a6e6fd12bc95c90a04">  409</a></span>    <span class="keywordtype">bool</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a00385a3163d3f2a6e6fd12bc95c90a04">is_off</a>() { <span class="keywordflow">return</span> <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a9afd8b7fefd3a00507666f8197c0f934">m_off</a>; }</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>  <span class="keyword">protected</span>:</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">  412</a></span>    std::shared_ptr&lt;LazyHandle&gt; <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">m_lazy_handle</a>;</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a9afd8b7fefd3a00507666f8197c0f934">  413</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a9afd8b7fefd3a00507666f8197c0f934">m_off</a> = <span class="keyword">false</span>; </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>  };</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">  416</a></span>  std::vector&lt;std::weak_ptr&lt;LazyHandle&gt;&gt; <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">m_lazy_handles</a>; </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#adffb2fe5e20a200af2a6656138d79907">  419</a></span>  <span class="keywordtype">void</span> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#adffb2fe5e20a200af2a6656138d79907">save_handle</a>(<span class="keyword">const</span> std::shared_ptr&lt;LazyHandle&gt; &amp;handle) {</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="keyword">auto</span> empty_handle =</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        std::find_if(<a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">m_lazy_handles</a>.begin(), <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">m_lazy_handles</a>.end(), [](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;el) { return el.expired(); });</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <span class="keywordflow">if</span> (empty_handle == <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">m_lazy_handles</a>.end())</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>      <a class="code hl_variable" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">m_lazy_handles</a>.push_back(handle);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>      *empty_handle = handle;</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>  }</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#acb672cde1dc9b5ed521c8efe0ae1b18e">  428</a></span>  <a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html">ProxyHandle</a> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#acb672cde1dc9b5ed521c8efe0ae1b18e">lazy_handle</a>(<a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html">ArrayHandler&lt;AL, AR&gt;</a> &amp;handler) {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <span class="keyword">auto</span> handle = std::make_shared&lt;typename ArrayHandler&lt;AL, AR&gt;::LazyHandle&gt;(handler);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#adffb2fe5e20a200af2a6656138d79907">save_handle</a>(handle);</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <span class="keywordflow">return</span> handle;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>  };</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span> </div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno"><a class="line" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a68c07505bdf99acceea83ad5d326859f">  436</a></span>  <span class="keyword">virtual</span> <a class="code hl_class" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html">ProxyHandle</a> <a class="code hl_function" href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a68c07505bdf99acceea83ad5d326859f">lazy_handle</a>() = 0;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>};</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>} <span class="comment">// namespace molpro::linalg::array</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span><span class="preprocessor">#endif </span><span class="comment">// LINEARALGEBRA_SRC_MOLPRO_LINALG_ARRAY_ARRAYHANDLER_H</span></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html">molpro::linalg::array::ArrayHandler::LazyHandle</a></div><div class="ttdoc">Registers operations for lazy evaluation. Evaluation is triggered by calling eval() or on destruction...</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:298</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a080b8c891ee0a335943d4dabdea0c72b"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a080b8c891ee0a335943d4dabdea0c72b">molpro::linalg::array::ArrayHandler::LazyHandle::axpy</a></div><div class="ttdeci">virtual void axpy(value_type alpha, const AR &amp;x, AL &amp;y)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:340</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a0ccd48ee6a0c2d874ee5fe395f188f1c"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a0ccd48ee6a0c2d874ee5fe395f188f1c">molpro::linalg::array::ArrayHandler::LazyHandle::eval</a></div><div class="ttdeci">virtual void eval()</div><div class="ttdoc">Calls handler to evaluate the registered operations.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:354</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a0f15d7a19a377c8460a142f68fea2e79"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a0f15d7a19a377c8460a142f68fea2e79">molpro::linalg::array::ArrayHandler::LazyHandle::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clear the registry.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:330</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a20dbb482f7200a82cc0212b595000d17"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a20dbb482f7200a82cc0212b595000d17">molpro::linalg::array::ArrayHandler::LazyHandle::dot</a></div><div class="ttdeci">virtual void dot(const AL &amp;x, const AR &amp;y, value_type &amp;out)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:346</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a23a0db1962c8e9f0217ace8b384a9d1a"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a23a0db1962c8e9f0217ace8b384a9d1a">molpro::linalg::array::ArrayHandler::LazyHandle::~LazyHandle</a></div><div class="ttdeci">virtual ~LazyHandle()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:338</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a37d2271aef475029d8ee6dbfbec32be8"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a37d2271aef475029d8ee6dbfbec32be8">molpro::linalg::array::ArrayHandler::LazyHandle::error</a></div><div class="ttdeci">void error(std::string message)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:312</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a3b0ae2897bbda5ae8b074fa06e762b0e"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a3b0ae2897bbda5ae8b074fa06e762b0e">molpro::linalg::array::ArrayHandler::LazyHandle::invalidate</a></div><div class="ttdeci">void invalidate()</div><div class="ttdoc">Flag the handler as invalid so that no new operations are registered operations eval() does nothing.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:373</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a45f59e92dce6d9b68af12131b82b4dc8"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a45f59e92dce6d9b68af12131b82b4dc8">molpro::linalg::array::ArrayHandler::LazyHandle::m_dot</a></div><div class="ttdeci">util::OperationRegister&lt; ref_wrap&lt; const AL &gt;, ref_wrap&lt; const AR &gt;, ref_wrap&lt; value_type &gt; &gt; m_dot</div><div class="ttdoc">register of dot operations</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:310</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a648de93bf4d1802ca4aabbbf0abff761"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a648de93bf4d1802ca4aabbbf0abff761">molpro::linalg::array::ArrayHandler::LazyHandle::LazyHandle</a></div><div class="ttdeci">LazyHandle(ArrayHandler&lt; AL, AR &gt; &amp;handler)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:337</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a6a3cffeecdcf7f3136b6a27849936268"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a6a3cffeecdcf7f3136b6a27849936268">molpro::linalg::array::ArrayHandler::LazyHandle::value_type</a></div><div class="ttdeci">ArrayHandler&lt; AL, AR &gt;::value_type value_type</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:300</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_a8095230db2e9ea0bc676664c1888fc3d"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#a8095230db2e9ea0bc676664c1888fc3d">molpro::linalg::array::ArrayHandler::LazyHandle::ref_wrap</a></div><div class="ttdeci">std::reference_wrapper&lt; T &gt; ref_wrap</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:302</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_ac1d6fbcbcac61819fbf795dbfef5aeb8"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ac1d6fbcbcac61819fbf795dbfef5aeb8">molpro::linalg::array::ArrayHandler::LazyHandle::m_handler</a></div><div class="ttdeci">ArrayHandler&lt; AL, AR &gt; &amp; m_handler</div><div class="ttdoc">all operations are still done through the handler</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:379</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_ad836493ce12da6c4bd02d927aaaff5d7"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad836493ce12da6c4bd02d927aaaff5d7">molpro::linalg::array::ArrayHandler::LazyHandle::m_op_types</a></div><div class="ttdeci">std::set&lt; std::string &gt; m_op_types</div><div class="ttdoc">Types of operations currently registered. Types are strings, because derived classes might add new op...</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:306</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_ad8f638facc5830ee0ccfe381c189da34"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#ad8f638facc5830ee0ccfe381c189da34">molpro::linalg::array::ArrayHandler::LazyHandle::m_invalid</a></div><div class="ttdeci">bool m_invalid</div><div class="ttdoc">flags if the handler has been destroyed and LazyHandle is now invalid</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:380</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_adaa97da1577894bcbae46700767188d9"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adaa97da1577894bcbae46700767188d9">molpro::linalg::array::ArrayHandler::LazyHandle::m_axpy</a></div><div class="ttdeci">util::OperationRegister&lt; value_type, ref_wrap&lt; const AR &gt;, ref_wrap&lt; AL &gt; &gt; m_axpy</div><div class="ttdoc">register of axpy operations</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:308</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_adc2f8a1d13761b128c1e1ed6adc08ba2"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#adc2f8a1d13761b128c1e1ed6adc08ba2">molpro::linalg::array::ArrayHandler::LazyHandle::invalid</a></div><div class="ttdeci">bool invalid()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:376</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle_html_af477f947fe6c798ef3d964aae63582e6"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1LazyHandle.html#af477f947fe6c798ef3d964aae63582e6">molpro::linalg::array::ArrayHandler::LazyHandle::register_op_type</a></div><div class="ttdeci">virtual bool register_op_type(const std::string &amp;type)</div><div class="ttdoc">Register an operation type.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:322</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html">molpro::linalg::array::ArrayHandler::ProxyHandle</a></div><div class="ttdoc">A convenience wrapper around a pointer to the LazyHandle.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:384</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_a00385a3163d3f2a6e6fd12bc95c90a04"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a00385a3163d3f2a6e6fd12bc95c90a04">molpro::linalg::array::ArrayHandler::ProxyHandle::is_off</a></div><div class="ttdeci">bool is_off()</div><div class="ttdoc">Returns true if lazy evaluation is off.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:409</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_a1fe711bb00bfc533ec16b1f663d4b124"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a1fe711bb00bfc533ec16b1f663d4b124">molpro::linalg::array::ArrayHandler::ProxyHandle::ProxyHandle</a></div><div class="ttdeci">ProxyHandle(std::shared_ptr&lt; LazyHandle &gt; handle)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:386</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_a3fbc8e8cf5973a81ee0dfff9f32aff74"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a3fbc8e8cf5973a81ee0dfff9f32aff74">molpro::linalg::array::ArrayHandler::ProxyHandle::eval</a></div><div class="ttdeci">void eval()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:400</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_a5daab75b9b2b8173e8787a734f5b521b"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a5daab75b9b2b8173e8787a734f5b521b">molpro::linalg::array::ArrayHandler::ProxyHandle::axpy</a></div><div class="ttdeci">void axpy(Args &amp;&amp;...args)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:389</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_a7666eaa8bcf4a9a1997e1f86dc76a24e"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a7666eaa8bcf4a9a1997e1f86dc76a24e">molpro::linalg::array::ArrayHandler::ProxyHandle::invalidate</a></div><div class="ttdeci">void invalidate()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:401</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_a94ae88f7320b91c880474a5ecae16d94"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a94ae88f7320b91c880474a5ecae16d94">molpro::linalg::array::ArrayHandler::ProxyHandle::invalid</a></div><div class="ttdeci">bool invalid()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:402</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_a9afd8b7fefd3a00507666f8197c0f934"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#a9afd8b7fefd3a00507666f8197c0f934">molpro::linalg::array::ArrayHandler::ProxyHandle::m_off</a></div><div class="ttdeci">bool m_off</div><div class="ttdoc">whether lazy evaluation is on or off</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:413</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_aa9281d9e60eeb5151eebf30fc3065b14"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#aa9281d9e60eeb5151eebf30fc3065b14">molpro::linalg::array::ArrayHandler::ProxyHandle::dot</a></div><div class="ttdeci">void dot(Args &amp;&amp;...args)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:395</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_ac075222a6329f35419e439a2ccadf36c"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#ac075222a6329f35419e439a2ccadf36c">molpro::linalg::array::ArrayHandler::ProxyHandle::on</a></div><div class="ttdeci">void on()</div><div class="ttdoc">Turn on lazy evaluation.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:407</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_ad0091fda4de382bbbe70a45e97a9e4a5"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#ad0091fda4de382bbbe70a45e97a9e4a5">molpro::linalg::array::ArrayHandler::ProxyHandle::off</a></div><div class="ttdeci">void off()</div><div class="ttdoc">Turn off lazy evaluation. Next operation will evaluate without delay.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:405</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle_html_afbcf9562ef99b911a7a41617a1613b99"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1ProxyHandle.html#afbcf9562ef99b911a7a41617a1613b99">molpro::linalg::array::ArrayHandler::ProxyHandle::m_lazy_handle</a></div><div class="ttdeci">std::shared_ptr&lt; LazyHandle &gt; m_lazy_handle</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:412</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html">molpro::linalg::array::ArrayHandler</a></div><div class="ttdoc">Enhances various operations between pairs of arrays and allows dynamic code injection with uniform in...</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:162</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a05ed79049a10cf88164895aa2da8c6c6"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a05ed79049a10cf88164895aa2da8c6c6">molpro::linalg::array::ArrayHandler::dot</a></div><div class="ttdeci">virtual value_type dot(const AL &amp;x, const AR &amp;y)=0</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a07fc7fcd247c2bc725a97ac15f2f7cb2"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a07fc7fcd247c2bc725a97ac15f2f7cb2">molpro::linalg::array::ArrayHandler::m_counter</a></div><div class="ttdeci">std::unique_ptr&lt; Counter &gt; m_counter</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:176</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a0cd5e391cf70fa6cf09acc8f72a55830"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a0cd5e391cf70fa6cf09acc8f72a55830">molpro::linalg::array::ArrayHandler::fused_dot</a></div><div class="ttdeci">virtual void fused_dot(const std::vector&lt; std::tuple&lt; size_t, size_t, size_t &gt; &gt; &amp;reg, const std::vector&lt; std::reference_wrapper&lt; const AL &gt; &gt; &amp;xx, const std::vector&lt; std::reference_wrapper&lt; const AR &gt; &gt; &amp;yy, std::vector&lt; std::reference_wrapper&lt; value_type &gt; &gt; &amp;out)</div><div class="ttdoc">Default implementation of fused_dot without any simplification.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:283</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a0cd8a03ec5ff22776cb80dacf55c0552"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a0cd8a03ec5ff22776cb80dacf55c0552">molpro::linalg::array::ArrayHandler::select</a></div><div class="ttdeci">virtual std::map&lt; size_t, value_type &gt; select(size_t n, const AL &amp;x, bool max=false, bool ignore_sign=false)=0</div><div class="ttdoc">Select n indices with largest (or smallest) actual (or absolute) value.</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a1750335b1260644a4dd836929ba1e2bf"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a1750335b1260644a4dd836929ba1e2bf">molpro::linalg::array::ArrayHandler::value_type_R</a></div><div class="ttdeci">typename array::mapped_or_value_type_t&lt; AR &gt; value_type_R</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:180</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a261ade4cb7ffb330d8876acda683440d"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a261ade4cb7ffb330d8876acda683440d">molpro::linalg::array::ArrayHandler::m_lazy_handles</a></div><div class="ttdeci">std::vector&lt; std::weak_ptr&lt; LazyHandle &gt; &gt; m_lazy_handles</div><div class="ttdoc">keeps track of all created lazy handles</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:416</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a2d055c67fa2b7087b03ada96877b842c"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a2d055c67fa2b7087b03ada96877b842c">molpro::linalg::array::ArrayHandler::scal</a></div><div class="ttdeci">virtual void scal(value_type alpha, AL &amp;x)=0</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a421d6107b2a60ffcdfb79d2d27c30c73"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a421d6107b2a60ffcdfb79d2d27c30c73">molpro::linalg::array::ArrayHandler::value_type_L</a></div><div class="ttdeci">typename array::mapped_or_value_type_t&lt; AL &gt; value_type_L</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:179</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a425ca68c78689a5eba39acdba92f364c"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a425ca68c78689a5eba39acdba92f364c">molpro::linalg::array::ArrayHandler::gemm_outer</a></div><div class="ttdeci">virtual void gemm_outer(const Matrix&lt; value_type &gt; alphas, const CVecRef&lt; AR &gt; &amp;xx, const VecRef&lt; AL &gt; &amp;yy)=0</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a439d2213a07466b54e366f4fa45b02de"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a439d2213a07466b54e366f4fa45b02de">molpro::linalg::array::ArrayHandler::value_type</a></div><div class="ttdeci">decltype(value_type_L{} *value_type_R{}) value_type</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:181</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a4e3e408ae09aaf1a463257dec668cb1f"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a4e3e408ae09aaf1a463257dec668cb1f">molpro::linalg::array::ArrayHandler::copy</a></div><div class="ttdeci">virtual AL copy(const AR &amp;source)=0</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a5e709cde75bb14f82ddddfb63d7d4e7e"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a5e709cde75bb14f82ddddfb63d7d4e7e">molpro::linalg::array::ArrayHandler::ArrayHandler</a></div><div class="ttdeci">ArrayHandler(const ArrayHandler &amp;)=default</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a6788b6924c2e9565d4cbac8e6c84109f"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a6788b6924c2e9565d4cbac8e6c84109f">molpro::linalg::array::ArrayHandler::copy</a></div><div class="ttdeci">virtual void copy(AL &amp;x, const AR &amp;y)=0</div><div class="ttdoc">Copy content of y into x.</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a68c07505bdf99acceea83ad5d326859f"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a68c07505bdf99acceea83ad5d326859f">molpro::linalg::array::ArrayHandler::lazy_handle</a></div><div class="ttdeci">virtual ProxyHandle lazy_handle()=0</div><div class="ttdoc">Returns a lazy handle. Most implementations simply need to call the overload: return lazy_handle(*thi...</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a6e145dd6a76d8ddea588f2104a9c140e"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a6e145dd6a76d8ddea588f2104a9c140e">molpro::linalg::array::ArrayHandler::axpy</a></div><div class="ttdeci">virtual void axpy(value_type alpha, const AR &amp;x, AL &amp;y)=0</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a8882095af0c40a0f6c678fec6f051391"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8882095af0c40a0f6c678fec6f051391">molpro::linalg::array::ArrayHandler::gemm_inner</a></div><div class="ttdeci">virtual Matrix&lt; value_type &gt; gemm_inner(const CVecRef&lt; AL &gt; &amp;xx, const CVecRef&lt; AR &gt; &amp;yy)=0</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a8c8021df8b9b0c3c449781783eb8a242"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8c8021df8b9b0c3c449781783eb8a242">molpro::linalg::array::ArrayHandler::fill</a></div><div class="ttdeci">virtual void fill(value_type alpha, AL &amp;x)=0</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a8d3ebad34f0f0b94a12816e50c7f3ee6"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a8d3ebad34f0f0b94a12816e50c7f3ee6">molpro::linalg::array::ArrayHandler::fused_axpy</a></div><div class="ttdeci">virtual void fused_axpy(const std::vector&lt; std::tuple&lt; size_t, size_t, size_t &gt; &gt; &amp;reg, const std::vector&lt; value_type &gt; &amp;alphas, const std::vector&lt; std::reference_wrapper&lt; const AR &gt; &gt; &amp;xx, std::vector&lt; std::reference_wrapper&lt; AL &gt; &gt; &amp;yy)</div><div class="ttdoc">Default implementation of fused_axpy without any simplification.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:271</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a961a362008722b7118640c95eb5189ac"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a961a362008722b7118640c95eb5189ac">molpro::linalg::array::ArrayHandler::select_max_dot</a></div><div class="ttdeci">virtual std::map&lt; size_t, value_type_abs &gt; select_max_dot(size_t n, const AL &amp;x, const AR &amp;y)=0</div><div class="ttdoc">Select n indices with largest by absolute value contributions to the dot product.</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_a9adcb3b8f3875d8706e792a0e09d5780"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#a9adcb3b8f3875d8706e792a0e09d5780">molpro::linalg::array::ArrayHandler::~ArrayHandler</a></div><div class="ttdeci">virtual ~ArrayHandler()</div><div class="ttdoc">Destroys ArrayHandler instance and invalidates any LazyHandler it created. Invalidated handler will n...</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:256</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_aab00b2597df72f3989554c25f8a55bdb"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#aab00b2597df72f3989554c25f8a55bdb">molpro::linalg::array::ArrayHandler::ArrayHandler</a></div><div class="ttdeci">ArrayHandler()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:164</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_aaeef8109bd1d949e8f413a399c0c29be"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#aaeef8109bd1d949e8f413a399c0c29be">molpro::linalg::array::ArrayHandler::counter_to_string</a></div><div class="ttdeci">std::string counter_to_string(std::string L, std::string R)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:226</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_abb16bb06ec4dfd2118e55f64087a204e"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#abb16bb06ec4dfd2118e55f64087a204e">molpro::linalg::array::ArrayHandler::value_type_abs</a></div><div class="ttdeci">decltype(check_abs&lt; value_type &gt;()) value_type_abs</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:182</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_abe05067f4eb67264edaef960015a9423"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#abe05067f4eb67264edaef960015a9423">molpro::linalg::array::ArrayHandler::counter</a></div><div class="ttdeci">const Counter &amp; counter() const</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:224</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_acb672cde1dc9b5ed521c8efe0ae1b18e"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#acb672cde1dc9b5ed521c8efe0ae1b18e">molpro::linalg::array::ArrayHandler::lazy_handle</a></div><div class="ttdeci">ProxyHandle lazy_handle(ArrayHandler&lt; AL, AR &gt; &amp;handler)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:428</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_ad70d4a3f485411537313606452fb75e6"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#ad70d4a3f485411537313606452fb75e6">molpro::linalg::array::ArrayHandler::error</a></div><div class="ttdeci">virtual void error(const std::string &amp;message)</div><div class="ttdoc">Throws an error.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:268</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_adffb2fe5e20a200af2a6656138d79907"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#adffb2fe5e20a200af2a6656138d79907">molpro::linalg::array::ArrayHandler::save_handle</a></div><div class="ttdeci">void save_handle(const std::shared_ptr&lt; LazyHandle &gt; &amp;handle)</div><div class="ttdoc">Save weak ptr to a lazy handle.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:419</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1array_1_1ArrayHandler_html_af6e2096242aea7daef3d8f0c1ee8df06"><div class="ttname"><a href="classmolpro_1_1linalg_1_1array_1_1ArrayHandler.html#af6e2096242aea7daef3d8f0c1ee8df06">molpro::linalg::array::ArrayHandler::clear_counter</a></div><div class="ttdeci">void clear_counter()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:246</div></div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1itsolv_1_1subspace_1_1Matrix_html"><div class="ttname"><a href="classmolpro_1_1linalg_1_1itsolv_1_1subspace_1_1Matrix.html">molpro::linalg::itsolv::subspace::Matrix</a></div><div class="ttdoc">Matrix container that allows simple data access, slicing, copying and resizing without loosing data.</div><div class="ttdef"><b>Definition:</b> Matrix.h:28</div></div>
<div class="ttc" id="anamespacemolpro_1_1linalg_1_1array_1_1util_html_a922d235e8c5336c4ef99bd5f966bb896"><div class="ttname"><a href="namespacemolpro_1_1linalg_1_1array_1_1util.html#a922d235e8c5336c4ef99bd5f966bb896">molpro::linalg::array::util::remove_duplicates</a></div><div class="ttdeci">std::tuple&lt; std::vector&lt; std::tuple&lt; size_t, size_t, size_t &gt; &gt;, std::vector&lt; X &gt;, std::vector&lt; Y &gt;, std::vector&lt; Z &gt; &gt; remove_duplicates(const std::list&lt; std::tuple&lt; X, Y, Z &gt; &gt; &amp;reg, EqualX equal_x, EqualY equal_y, EqualZ equal_z)</div><div class="ttdoc">Find duplicates references to x and y arrays and store unique elements in a separate vector.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:74</div></div>
<div class="ttc" id="anamespacemolpro_1_1linalg_1_1array_html"><div class="ttname"><a href="namespacemolpro_1_1linalg_1_1array.html">molpro::linalg::array</a></div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:22</div></div>
<div class="ttc" id="anamespacemolpro_1_1linalg_1_1array_html_a5aeb80119c6ea1e4cd9155b6fb025344"><div class="ttname"><a href="namespacemolpro_1_1linalg_1_1array.html#a5aeb80119c6ea1e4cd9155b6fb025344">molpro::linalg::array::mapped_or_value_type_t</a></div><div class="ttdeci">typename mapped_or_value_type&lt; A &gt;::type mapped_or_value_type_t</div><div class="ttdef"><b>Definition:</b> type_traits.h:37</div></div>
<div class="ttc" id="anamespacemolpro_1_1linalg_1_1itsolv_html_aafd1821a97ea122d56be347e38e90a89"><div class="ttname"><a href="namespacemolpro_1_1linalg_1_1itsolv.html#aafd1821a97ea122d56be347e38e90a89">molpro::linalg::itsolv::CVecRef</a></div><div class="ttdeci">std::vector&lt; std::reference_wrapper&lt; const A &gt; &gt; CVecRef</div><div class="ttdef"><b>Definition:</b> wrap.h:14</div></div>
<div class="ttc" id="anamespacemolpro_1_1linalg_1_1itsolv_html_ab44c7c7dfce88d39d260d1f5c7b70fab"><div class="ttname"><a href="namespacemolpro_1_1linalg_1_1itsolv.html#ab44c7c7dfce88d39d260d1f5c7b70fab">molpro::linalg::itsolv::VecRef</a></div><div class="ttdeci">std::vector&lt; std::reference_wrapper&lt; A &gt; &gt; VecRef</div><div class="ttdef"><b>Definition:</b> wrap.h:11</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter_html"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html">molpro::linalg::array::ArrayHandler::Counter</a></div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:167</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter_html_a5ad2b6f45fd33ca55ec7c1b110f2066e"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a5ad2b6f45fd33ca55ec7c1b110f2066e">molpro::linalg::array::ArrayHandler::Counter::dot</a></div><div class="ttdeci">int dot</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:169</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter_html_a5cbd61f446c2aaf730f319376be95331"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a5cbd61f446c2aaf730f319376be95331">molpro::linalg::array::ArrayHandler::Counter::gemm_inner</a></div><div class="ttdeci">int gemm_inner</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:172</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter_html_a6241ac3f1e9f88d16def846e3d5ed5f4"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a6241ac3f1e9f88d16def846e3d5ed5f4">molpro::linalg::array::ArrayHandler::Counter::copy</a></div><div class="ttdeci">int copy</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:171</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter_html_a79929e52bd35c9046eb3e9dca6f2b71f"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a79929e52bd35c9046eb3e9dca6f2b71f">molpro::linalg::array::ArrayHandler::Counter::axpy</a></div><div class="ttdeci">int axpy</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:170</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter_html_a81a28a4bc061af75fec23768979e1bc2"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a81a28a4bc061af75fec23768979e1bc2">molpro::linalg::array::ArrayHandler::Counter::gemm_outer</a></div><div class="ttdeci">int gemm_outer</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:173</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter_html_a9d520e242d7fcaaa775768eaf9a834dc"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1ArrayHandler_1_1Counter.html#a9d520e242d7fcaaa775768eaf9a834dc">molpro::linalg::array::ArrayHandler::Counter::scal</a></div><div class="ttdeci">int scal</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:168</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1ArrayHandlerError_html"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1ArrayHandlerError.html">molpro::linalg::array::util::ArrayHandlerError</a></div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:25</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister_html"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html">molpro::linalg::array::util::OperationRegister</a></div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:32</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister_html_a10215e9ae57e6cede38da1ce2e899022"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a10215e9ae57e6cede38da1ce2e899022">molpro::linalg::array::util::OperationRegister::m_register</a></div><div class="ttdeci">std::list&lt; std::tuple&lt; Args... &gt; &gt; m_register</div><div class="ttdoc">ordered register of operations</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:34</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister_html_a85d5441e4a6d527c6672878ab2dad9f1"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a85d5441e4a6d527c6672878ab2dad9f1">molpro::linalg::array::util::OperationRegister::push</a></div><div class="ttdeci">void push(const Args &amp;...args, ArgEqual equal)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:41</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister_html_a91d2643100e88fafe2a373d4ba66f9b9"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#a91d2643100e88fafe2a373d4ba66f9b9">molpro::linalg::array::util::OperationRegister::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:58</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister_html_aa0c23529a797aa3a5f2c0b2926cba03f"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#aa0c23529a797aa3a5f2c0b2926cba03f">molpro::linalg::array::util::OperationRegister::empty</a></div><div class="ttdeci">bool empty()</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:57</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister_html_adec453c471eab2cf48d7c8c43a9e31c2"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#adec453c471eab2cf48d7c8c43a9e31c2">molpro::linalg::array::util::OperationRegister::OP</a></div><div class="ttdeci">std::tuple&lt; Args... &gt; OP</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:33</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister_html_adf738d84096126b2c6442399eafebd8a"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1OperationRegister.html#adf738d84096126b2c6442399eafebd8a">molpro::linalg::array::util::OperationRegister::push</a></div><div class="ttdeci">void push(const Args &amp;...args)</div><div class="ttdoc">Register each operation as it comes with no reordering.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:55</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual_html"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html">molpro::linalg::array::util::RefEqual</a></div><div class="ttdoc">When called returns true if addresses of two references are the same.</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:104</div></div>
<div class="ttc" id="astructmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual_html_a1d71d8c5238f6cddb1a15db36ecbb882"><div class="ttname"><a href="structmolpro_1_1linalg_1_1array_1_1util_1_1RefEqual.html#a1d71d8c5238f6cddb1a15db36ecbb882">molpro::linalg::array::util::RefEqual::operator()</a></div><div class="ttdeci">bool operator()(const std::reference_wrapper&lt; T &gt; &amp;l, const std::reference_wrapper&lt; T &gt; &amp;r)</div><div class="ttdef"><b>Definition:</b> ArrayHandler.h:105</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_3a0534501ca4be4079425efd3c8ffab8.html">__w</a></li><li class="navelem"><a class="el" href="dir_1c54602c28b426a9deb714a4c70fb829.html">iterative-solver</a></li><li class="navelem"><a class="el" href="dir_a563af09b26884aad75529c5aa777bcc.html">iterative-solver</a></li><li class="navelem"><a class="el" href="dir_eb4d126b3fa7bf979eab373ec99a049d.html">src</a></li><li class="navelem"><a class="el" href="dir_7b4fabcf2465e7fcf2ed44da3b2bc9bc.html">molpro</a></li><li class="navelem"><a class="el" href="dir_5118a47b4b86506f75c9c5cb0e93597f.html">linalg</a></li><li class="navelem"><a class="el" href="dir_1bca3633a159feb7f24e3d6f353f8b7c.html">array</a></li><li class="navelem"><b>ArrayHandler.h</b></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
