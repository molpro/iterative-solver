<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iterative-solver: iterative_solver Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iterative-solver<span id="projectnumber">&#160;0.0</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespaceiterative__solver.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">iterative_solver Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>IterativeSolver Fortran binding.  
<a href="namespaceiterative__solver.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceiterative__solver_1_1mpi__init.html">mpi_init</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceiterative__solver_1_1mpi__rank__global.html">mpi_rank_global</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a762cf435ede70697d8e9df140d410d27"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a762cf435ede70697d8e9df140d410d27">test_select</a></td></tr>
<tr class="separator:a762cf435ede70697d8e9df140d410d27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2890fe920d167483bcac382af12afe5d"><td class="memItemLeft" align="right" valign="top">integer(kind=<a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a2890fe920d167483bcac382af12afe5d">mpicomm_compute</a> ()</td></tr>
<tr class="separator:a2890fe920d167483bcac382af12afe5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a508258aa021cc2d872fba06bd1cff849"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a508258aa021cc2d872fba06bd1cff849">set_mpicomm_compute</a> (comm)</td></tr>
<tr class="separator:a508258aa021cc2d872fba06bd1cff849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ec8e7c839d5189981da473f64b78ade"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a0ec8e7c839d5189981da473f64b78ade">solve_linear_eigensystem</a> (parameters, actions, <a class="el" href="structiterative__solver__problem_1_1problem.html">problem</a>, nroot, generate_initial_guess, max_iter, max_p, thresh, thresh_value, hermitian, verbosity, pname, mpicomm, algorithm, range, options)</td></tr>
<tr class="separator:a0ec8e7c839d5189981da473f64b78ade"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce14b9eca351507039f752494a53349"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a0ce14b9eca351507039f752494a53349">solve_linear_equations</a> (parameters, actions, <a class="el" href="structiterative__solver__problem_1_1problem.html">problem</a>, generate_initial_guess, max_iter, max_p, augmented_hessian, thresh, thresh_value, hermitian, verbosity, pname, mpicomm, algorithm, range, options)</td></tr>
<tr class="separator:a0ce14b9eca351507039f752494a53349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05c7eeda78e69ee7c484fe069ab0231b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a05c7eeda78e69ee7c484fe069ab0231b">solve_nonlinear_equations</a> (parameters, actions, <a class="el" href="structiterative__solver__problem_1_1problem.html">problem</a>, nroot, generate_initial_guess, max_iter, thresh, hermitian, verbosity, pname, mpicomm, algorithm, range, options)</td></tr>
<tr class="separator:a05c7eeda78e69ee7c484fe069ab0231b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc0c445dbb353da38c92aa1ce4640f2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#aafc0c445dbb353da38c92aa1ce4640f2">solve_optimization</a> (parameters, actions, <a class="el" href="structiterative__solver__problem_1_1problem.html">problem</a>, nroot, generate_initial_guess, max_iter, thresh, thresh_value, hermitian, verbosity, minimize, pname, mpicomm, algorithm, range, options)</td></tr>
<tr class="separator:aafc0c445dbb353da38c92aa1ce4640f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeac19cec453d5df15b17ea1b0f157fb"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#aeeac19cec453d5df15b17ea1b0f157fb">iterative_solver_linear_eigensystem_initialize</a> (nq, nroot, thresh, thresh_value, hermitian, verbosity, pname, mpicomm, algorithm, range, options)</td></tr>
<tr class="memdesc:aeeac19cec453d5df15b17ea1b0f157fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the lowest eigensolutions of a matrix. The default algorithm is Davidson's method, i.e. preconditioned Lanczos. Example of simplest use:  <a href="namespaceiterative__solver.html#aeeac19cec453d5df15b17ea1b0f157fb">More...</a><br /></td></tr>
<tr class="separator:aeeac19cec453d5df15b17ea1b0f157fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c4bfefb260bc5df5c34a84a24a3138"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a69c4bfefb260bc5df5c34a84a24a3138">iterative_solver_linear_equations_initialize</a> (nq, nroot, rhs, augmented_hessian, thresh, thresh_value, hermitian, verbosity, pname, mpicomm, algorithm, range, options)</td></tr>
<tr class="memdesc:a69c4bfefb260bc5df5c34a84a24a3138"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the solutions of linear equation systems using a generalisation of Davidson's method, i.e. preconditioned Lanczos Example of simplest use:  <a href="namespaceiterative__solver.html#a69c4bfefb260bc5df5c34a84a24a3138">More...</a><br /></td></tr>
<tr class="separator:a69c4bfefb260bc5df5c34a84a24a3138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ec1c6cf65a2f9d40f2035e7ca0b77ec"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a7ec1c6cf65a2f9d40f2035e7ca0b77ec">iterative_solver_optimize_initialize</a> (nq, thresh, verbosity, minimize, pname, mpicomm, algorithm, range, thresh_value, options)</td></tr>
<tr class="memdesc:a7ec1c6cf65a2f9d40f2035e7ca0b77ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optimization through the L-BFGS or related methods. Example of simplest use:  <a href="namespaceiterative__solver.html#a7ec1c6cf65a2f9d40f2035e7ca0b77ec">More...</a><br /></td></tr>
<tr class="separator:a7ec1c6cf65a2f9d40f2035e7ca0b77ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0193308603bbbe44226e4745032d12f7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a0193308603bbbe44226e4745032d12f7">iterative_solver_diis_initialize</a> (nq, thresh, verbosity, pname, mpicomm, algorithm, range, options)</td></tr>
<tr class="memdesc:a0193308603bbbe44226e4745032d12f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accelerated convergence of non-linear equations through the DIIS or related methods. Example of simplest use:  <a href="namespaceiterative__solver.html#a0193308603bbbe44226e4745032d12f7">More...</a><br /></td></tr>
<tr class="separator:a0193308603bbbe44226e4745032d12f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40a3d04d226f8315ed2a57baa5d78304"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a40a3d04d226f8315ed2a57baa5d78304">iterative_solver_finalize</a></td></tr>
<tr class="memdesc:a40a3d04d226f8315ed2a57baa5d78304"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminate the iterative solver.  <a href="namespaceiterative__solver.html#a40a3d04d226f8315ed2a57baa5d78304">More...</a><br /></td></tr>
<tr class="separator:a40a3d04d226f8315ed2a57baa5d78304"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2174400663d4e6e433bf197150e423ce"><td class="memItemLeft" align="right" valign="top">integer function, dimension(2)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a2174400663d4e6e433bf197150e423ce">iterative_solver_range</a> ()</td></tr>
<tr class="separator:a2174400663d4e6e433bf197150e423ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70258968c6cc6e822b9008afcccd8a79"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a70258968c6cc6e822b9008afcccd8a79">iterative_solver_add_vector</a> (parameters, action, synchronize, value)</td></tr>
<tr class="memdesc:a70258968c6cc6e822b9008afcccd8a79"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take, typically, a current solution and residual, add it to the expansion set, and return new solution. In the context of Lanczos-like linear methods, the input will be a current expansion vector and the result of acting on it with the matrix, and the output will be a new expansion vector.  <a href="namespaceiterative__solver.html#a70258968c6cc6e822b9008afcccd8a79">More...</a><br /></td></tr>
<tr class="separator:a70258968c6cc6e822b9008afcccd8a79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8b03a6e82fb1df6df6b25e5017d3714"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#aa8b03a6e82fb1df6df6b25e5017d3714">iterative_solver_add_equations</a> (rhs)</td></tr>
<tr class="memdesc:aa8b03a6e82fb1df6df6b25e5017d3714"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a right hand side to augment the set of linear equations to be solved.  <a href="namespaceiterative__solver.html#aa8b03a6e82fb1df6df6b25e5017d3714">More...</a><br /></td></tr>
<tr class="separator:aa8b03a6e82fb1df6df6b25e5017d3714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03f7586355d8dab8557e6cde9fc0078b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a03f7586355d8dab8557e6cde9fc0078b">iterative_solver_solution</a> (roots, parameters, action, synchronize)</td></tr>
<tr class="memdesc:a03f7586355d8dab8557e6cde9fc0078b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the current solution.  <a href="namespaceiterative__solver.html#a03f7586355d8dab8557e6cde9fc0078b">More...</a><br /></td></tr>
<tr class="separator:a03f7586355d8dab8557e6cde9fc0078b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad609af42ab2050142d98f5ca57522322"><td class="memItemLeft" align="right" valign="top">function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#ad609af42ab2050142d98f5ca57522322">iterative_solver_end_iteration</a> (solution, residual, synchronize)</td></tr>
<tr class="memdesc:ad609af42ab2050142d98f5ca57522322"><td class="mdescLeft">&#160;</td><td class="mdescRight">For most methods, does nothing; for Optimize it is required. Also write progress to standard output.  <a href="namespaceiterative__solver.html#ad609af42ab2050142d98f5ca57522322">More...</a><br /></td></tr>
<tr class="separator:ad609af42ab2050142d98f5ca57522322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b5146c464788a63c87081ee8f50473d"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a5b5146c464788a63c87081ee8f50473d">iterative_solver_end_iteration_needed</a> ()</td></tr>
<tr class="separator:a5b5146c464788a63c87081ee8f50473d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa924c3a27ae8d7dfb5f6946c9ab55222"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#aa924c3a27ae8d7dfb5f6946c9ab55222">iterative_solver_add_p</a> (nP, offsets, indices, coefficients, pp, parameters, action, fproc, synchronize)</td></tr>
<tr class="memdesc:aa924c3a27ae8d7dfb5f6946c9ab55222"><td class="mdescLeft">&#160;</td><td class="mdescRight">add P-space vectors to the expansion set, and return new solution.  <a href="namespaceiterative__solver.html#aa924c3a27ae8d7dfb5f6946c9ab55222">More...</a><br /></td></tr>
<tr class="separator:aa924c3a27ae8d7dfb5f6946c9ab55222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5165398f200e5ac77b1a80676108cc29"><td class="memItemLeft" align="right" valign="top">integer function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a5165398f200e5ac77b1a80676108cc29">iterative_solver_suggest_p</a> (solution, residual, indices, threshold)</td></tr>
<tr class="memdesc:a5165398f200e5ac77b1a80676108cc29"><td class="mdescLeft">&#160;</td><td class="mdescRight">Take an existing solution and its residual, and suggest P vectors.  <a href="namespaceiterative__solver.html#a5165398f200e5ac77b1a80676108cc29">More...</a><br /></td></tr>
<tr class="separator:a5165398f200e5ac77b1a80676108cc29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8771b451fe4f3381b22d6a64d96f23bd"><td class="memItemLeft" align="right" valign="top">double precision function, dimension(:), allocatable, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a8771b451fe4f3381b22d6a64d96f23bd">iterative_solver_errors</a> ()</td></tr>
<tr class="memdesc:a8771b451fe4f3381b22d6a64d96f23bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">errors for each root  <a href="namespaceiterative__solver.html#a8771b451fe4f3381b22d6a64d96f23bd">More...</a><br /></td></tr>
<tr class="separator:a8771b451fe4f3381b22d6a64d96f23bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afad8d58daf37b4b32e1f85046611ece6"><td class="memItemLeft" align="right" valign="top">double precision function, dimension(m_nroot), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#afad8d58daf37b4b32e1f85046611ece6">iterative_solver_eigenvalues</a> ()</td></tr>
<tr class="memdesc:afad8d58daf37b4b32e1f85046611ece6"><td class="mdescLeft">&#160;</td><td class="mdescRight">the lowest eigenvalues of the reduced problem, for the number of roots sought.  <a href="namespaceiterative__solver.html#afad8d58daf37b4b32e1f85046611ece6">More...</a><br /></td></tr>
<tr class="separator:afad8d58daf37b4b32e1f85046611ece6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11e3d198ebd7872c9ed08cbbdf9dd012"><td class="memItemLeft" align="right" valign="top">double precision function, dimension(working_set_size), public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a11e3d198ebd7872c9ed08cbbdf9dd012">iterative_solver_working_set_eigenvalues</a> (working_set_size)</td></tr>
<tr class="memdesc:a11e3d198ebd7872c9ed08cbbdf9dd012"><td class="mdescLeft">&#160;</td><td class="mdescRight">the eigenvalues of the reduced problem, for the number of roots in working set (not yet converged).  <a href="namespaceiterative__solver.html#a11e3d198ebd7872c9ed08cbbdf9dd012">More...</a><br /></td></tr>
<tr class="separator:a11e3d198ebd7872c9ed08cbbdf9dd012"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed2ec3b74a21dd29d3ab3853ace408b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#aeed2ec3b74a21dd29d3ab3853ace408b">iterative_solver_solve</a> (parameters, actions, <a class="el" href="structiterative__solver__problem_1_1problem.html">problem</a>, generate_initial_guess, max_iter, max_p)</td></tr>
<tr class="separator:aeed2ec3b74a21dd29d3ab3853ace408b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e077733271d54ad4d3182d2d9aeb9ab"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a3e077733271d54ad4d3182d2d9aeb9ab">iterative_solver_converged</a> ()</td></tr>
<tr class="separator:a3e077733271d54ad4d3182d2d9aeb9ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af549c18c82c1991ba10874982d745626"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#af549c18c82c1991ba10874982d745626">apply_p_current_problem</a> (p, g, nvec, ranges)</td></tr>
<tr class="separator:af549c18c82c1991ba10874982d745626"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8e7b0afa0169579bd571c1aac764d4e8"><td class="memItemLeft" align="right" valign="top">integer, parameter, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a> = KIND(c_int64_t)</td></tr>
<tr class="separator:a8e7b0afa0169579bd571c1aac764d4e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a260bebdd67c530e7e08bf211bc44760b"><td class="memItemLeft" align="right" valign="top">integer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#a260bebdd67c530e7e08bf211bc44760b">iterative_solver_iterations</a></td></tr>
<tr class="separator:a260bebdd67c530e7e08bf211bc44760b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1ae0165bd555ba3fbf8d9c6e55d83c0"><td class="memItemLeft" align="right" valign="top">class(problem_class), pointer, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceiterative__solver.html#ad1ae0165bd555ba3fbf8d9c6e55d83c0">current_problem</a></td></tr>
<tr class="separator:ad1ae0165bd555ba3fbf8d9c6e55d83c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >IterativeSolver Fortran binding. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="af549c18c82c1991ba10874982d745626" name="af549c18c82c1991ba10874982d745626"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af549c18c82c1991ba10874982d745626">&#9670;&nbsp;</a></span>apply_p_current_problem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::apply_p_current_problem </td>
          <td>(</td>
          <td class="paramtype">real(c_double), dimension(<a class="el" href="namespaceiterative__solver.html#ad1ae0165bd555ba3fbf8d9c6e55d83c0">current_problem</a>%p_space%size, nvec), intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(c_double), dimension(m_nq, nvec), intent(inout)&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(c_size_t), intent(in), value&#160;</td>
          <td class="paramname"><em>nvec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(c_size_t), dimension(2, nvec), intent(in)&#160;</td>
          <td class="paramname"><em>ranges</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa8b03a6e82fb1df6df6b25e5017d3714" name="aa8b03a6e82fb1df6df6b25e5017d3714"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8b03a6e82fb1df6df6b25e5017d3714">&#9670;&nbsp;</a></span>iterative_solver_add_equations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine iterative_solver::iterative_solver_add_equations </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(..), intent(in), target&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a right hand side to augment the set of linear equations to be solved. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rhs</td><td>On input, the desired RHS </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa924c3a27ae8d7dfb5f6946c9ab55222" name="aa924c3a27ae8d7dfb5f6946c9ab55222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa924c3a27ae8d7dfb5f6946c9ab55222">&#9670;&nbsp;</a></span>iterative_solver_add_p()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public iterative_solver::iterative_solver_add_p </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(0:np), intent(in)&#160;</td>
          <td class="paramname"><em>offsets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(offsets(np)), intent(in)&#160;</td>
          <td class="paramname"><em>indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(offsets(np)), intent(in)&#160;</td>
          <td class="paramname"><em>coefficients</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>pp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(:, :), intent(inout)&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(:, :), intent(inout)&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">external&#160;</td>
          <td class="paramname"><em>fproc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>synchronize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>add P-space vectors to the expansion set, and return new solution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nP</td><td>the number of P-space vectors to add </td></tr>
    <tr><td class="paramname">offsets</td><td>specifies the start point in indices and coefficients that defines each vector. </td></tr>
    <tr><td class="paramname">indices</td><td>Index in the full space of a contribution to a new P vector </td></tr>
    <tr><td class="paramname">coefficients</td><td>Value of a contribution to a new P vector </td></tr>
    <tr><td class="paramname">pp</td><td>The P-P block of the matrix, dimensioned (number of existing P + nP, nP) </td></tr>
    <tr><td class="paramname">parameters</td><td>On input, the current solution or expansion vector. On exit, the interpolated solution vector. </td></tr>
    <tr><td class="paramname">action</td><td>On input, the residual for parameters (non-linear), or action of matrix on parameters (linear). </td></tr>
    <tr><td class="paramname">fproc</td><td></td></tr>
    <tr><td class="paramname">synchronize</td><td>Whether to synchronize any distributed storage of parameters and action before return. Unnecessary if the client preconditioner is diagonal, but otherwise should be done. The default is the safe .TRUE. but can be .FALSE. if appropriate. On exit, the expected (non-linear) or actual (linear) residual of the interpolated parameters. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a70258968c6cc6e822b9008afcccd8a79" name="a70258968c6cc6e822b9008afcccd8a79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70258968c6cc6e822b9008afcccd8a79">&#9670;&nbsp;</a></span>iterative_solver_add_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public iterative_solver::iterative_solver_add_vector </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>synchronize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, optional&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take, typically, a current solution and residual, add it to the expansion set, and return new solution. In the context of Lanczos-like linear methods, the input will be a current expansion vector and the result of acting on it with the matrix, and the output will be a new expansion vector. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parameters</td><td>On input, the current solution or expansion vector. On exit, the interpolated solution vector. </td></tr>
    <tr><td class="paramname">action</td><td>On input, the residual for parameters (non-linear), or action of matrix on parameters (linear). On exit, the expected (non-linear) or actual (linear) residual of the interpolated parameters. </td></tr>
    <tr><td class="paramname">synchronize</td><td>Whether to synchronize any distributed storage of parameters and action before return. Unnecessary if the client preconditioner is diagonal, but otherwise should be done. The default is the safe .TRUE. but can be .FALSE. if appropriate. </td></tr>
    <tr><td class="paramname">value</td><td>The value of the objective function for parameters. Used only in non-linear optimization. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the size of the working set for the next iteration. The client is expected to apply any preconditioner to this number of vectors in action before the subsequent call to Iterative_Solver_End_Iteration(). In non-linear optimisation, the special value -1 can also be returned, indicating that preconditioning should not be carried out on action. </dd></dl>

</div>
</div>
<a id="a3e077733271d54ad4d3182d2d9aeb9ab" name="a3e077733271d54ad4d3182d2d9aeb9ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e077733271d54ad4d3182d2d9aeb9ab">&#9670;&nbsp;</a></span>iterative_solver_converged()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public iterative_solver::iterative_solver_converged</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0193308603bbbe44226e4745032d12f7" name="a0193308603bbbe44226e4745032d12f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0193308603bbbe44226e4745032d12f7">&#9670;&nbsp;</a></span>iterative_solver_diis_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::iterative_solver_diis_initialize </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>pname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accelerated convergence of non-linear equations through the DIIS or related methods. Example of simplest use: </p>
<div class="fragment"></div><!-- fragment --> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nq</td><td>dimension of parameter space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>convergence threshold </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>how much to print. Default is zero, which prints nothing except errors. One gives a single progress-report line each iteration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pname</td><td>Profiler object name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>Profiler communicator </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algorithm</td><td>algorithm, eg DIIS </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">range</td><td>distributed array local range start and end indices </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>key1=value1, key2=value1,... to specify arbitrary options </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afad8d58daf37b4b32e1f85046611ece6" name="afad8d58daf37b4b32e1f85046611ece6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afad8d58daf37b4b32e1f85046611ece6">&#9670;&nbsp;</a></span>iterative_solver_eigenvalues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function, dimension(m_nroot), public iterative_solver::iterative_solver_eigenvalues</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the lowest eigenvalues of the reduced problem, for the number of roots sought. </p>

</div>
</div>
<a id="ad609af42ab2050142d98f5ca57522322" name="ad609af42ab2050142d98f5ca57522322"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad609af42ab2050142d98f5ca57522322">&#9670;&nbsp;</a></span>iterative_solver_end_iteration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function, public iterative_solver::iterative_solver_end_iteration </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>residual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>synchronize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For most methods, does nothing; for Optimize it is required. Also write progress to standard output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">solution</td><td>On exit, the new vectors targeting roots in the working set. </td></tr>
    <tr><td class="paramname">residual</td><td>On entry, the preconditioned residual. On exit, undefined. </td></tr>
    <tr><td class="paramname">synchronize</td><td>Whether to synchronize any distributed storage of parameters before return. The default is the safe .TRUE. but can be .FALSE. if appropriate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The size of the working set </dd></dl>

</div>
</div>
<a id="a5b5146c464788a63c87081ee8f50473d" name="a5b5146c464788a63c87081ee8f50473d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b5146c464788a63c87081ee8f50473d">&#9670;&nbsp;</a></span>iterative_solver_end_iteration_needed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public iterative_solver::iterative_solver_end_iteration_needed</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8771b451fe4f3381b22d6a64d96f23bd" name="a8771b451fe4f3381b22d6a64d96f23bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8771b451fe4f3381b22d6a64d96f23bd">&#9670;&nbsp;</a></span>iterative_solver_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function, dimension(:), allocatable, public iterative_solver::iterative_solver_errors</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>errors for each root </p>

</div>
</div>
<a id="a40a3d04d226f8315ed2a57baa5d78304" name="a40a3d04d226f8315ed2a57baa5d78304"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a3d04d226f8315ed2a57baa5d78304">&#9670;&nbsp;</a></span>iterative_solver_finalize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::iterative_solver_finalize</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminate the iterative solver. </p>

</div>
</div>
<a id="aeeac19cec453d5df15b17ea1b0f157fb" name="aeeac19cec453d5df15b17ea1b0f157fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeeac19cec453d5df15b17ea1b0f157fb">&#9670;&nbsp;</a></span>iterative_solver_linear_eigensystem_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::iterative_solver_linear_eigensystem_initialize </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nroot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>hermitian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>pname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the lowest eigensolutions of a matrix. The default algorithm is Davidson's method, i.e. preconditioned Lanczos. Example of simplest use: </p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">PROGRAM</span> linear_eigensystem_example</div>
<div class="line">  <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespaceiterative__solver.html">iterative_solver</a>, <span class="keywordtype">only</span> : <a class="code hl_interface" href="interfaceiterative__solver_1_1mpi__init.html">mpi_init</a>, mpi_finalize, <a class="code hl_interface" href="interfaceiterative__solver_1_1mpi__rank__global.html">mpi_rank_global</a>, &amp;</div>
<div class="line">      solve_linear_eigensystem, iterative_solver_print_statistics, iterative_solver_finalize</div>
<div class="line">  <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespaceiterative__solver__matrix__problem.html">iterative_solver_matrix_problem</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structiterative__solver__matrix__problem_1_1matrix__problem.html">matrix_problem</a></div>
<div class="line">  <span class="keywordtype">USE </span>iso_fortran_env, <span class="keywordtype">only</span> : output_unit</div>
<div class="line">  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: n = 300, nroot = 3</div>
<div class="line">  <span class="keywordtype">INTEGER</span> :: nP, max_p</div>
<div class="line">  <span class="keywordtype">DOUBLE PRECISION</span>, <span class="keywordtype">DIMENSION (:, :)</span>, <span class="keywordtype">allocatable</span>, <span class="keywordtype">target</span> :: m</div>
<div class="line">  <span class="keywordtype">INTEGER</span> :: i</div>
<div class="line">  <span class="keyword">CALL </span><a class="code hl_interface" href="interfaceiterative__solver_1_1mpi__init.html">mpi_init</a></div>
<div class="line">  <span class="keywordflow">IF</span> (<a class="code hl_interface" href="interfaceiterative__solver_1_1mpi__rank__global.html">mpi_rank_global</a>() .gt. 0) <span class="keyword">close</span>(output_unit)</div>
<div class="line">  <span class="keyword">ALLOCATE</span>(m(n, n))</div>
<div class="line">  m = 1</div>
<div class="line">  <span class="keywordflow">DO</span> i = lbound(m,1), ubound(m,1)</div>
<div class="line">    m(i, i) = 3 * (n + 1 - i)</div>
<div class="line"><span class="keywordflow">  END DO</span></div>
<div class="line">  <span class="keywordflow">do</span> np = 0, 50, 50</div>
<div class="line">    <span class="keywordflow">do</span> max_p = 0, 50, 10</div>
<div class="line">      <span class="keywordflow">if</span> (max_p.gt.0 .and. np.gt.0) cycle</div>
<div class="line">      <span class="keyword">WRITE</span> (6, *) <span class="stringliteral">&#39;Explicit P-space=&#39;</span>, np, <span class="stringliteral">&#39;, auto P-space=&#39;</span>, max_p, <span class="stringliteral">&#39;, dimension=&#39;</span>, n, <span class="stringliteral">&#39;, roots=&#39;</span>, nroot</div>
<div class="line">      <span class="keyword">call </span>solve(m, np, max_p)</div>
<div class="line"><span class="keywordflow">    end do</span></div>
<div class="line"><span class="keywordflow">  end do</span></div>
<div class="line">  <span class="keyword">DEALLOCATE</span>(m)</div>
<div class="line">  <span class="keyword">CALL </span>mpi_finalize</div>
<div class="line"><span class="keyword">CONTAINS</span></div>
<div class="line">  <span class="keyword">subroutine </span>solve(m, nP, max_P)</div>
<div class="line">    <span class="keywordtype">DOUBLE PRECISION</span>, <span class="keywordtype">DIMENSION (:, :)</span>, <span class="keywordtype">INTENT(IN)</span>, <span class="keywordtype">target</span> :: m</div>
<div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: nP, max_P</div>
<div class="line">    <span class="keywordtype">DOUBLE PRECISION</span>, <span class="keywordtype">DIMENSION (ubound(m,1), nroot)</span> :: c, g</div>
<div class="line">    <span class="keywordtype">TYPE</span>(Matrix_Problem) :: problem</div>
<div class="line">    <span class="keyword">CALL </span>problem%attach(m)</div>
<div class="line">    <span class="keyword">CALL </span>problem%p_space%add_simple([(i, i = 1, np)]) <span class="comment">! the first nP components, so not the best</span></div>
<div class="line">    <span class="keyword">CALL </span>solve_linear_eigensystem(c, g, problem, nroot, verbosity = 2, thresh = 1d-8, hermitian = .true., max_p = max_p)</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_interface" href="interfaceiterative__solver_1_1mpi__rank__global.html">mpi_rank_global</a>().eq.0) <span class="keyword">CALL </span>iterative_solver_print_statistics</div>
<div class="line">    <span class="keyword">CALL </span>iterative_solver_finalize</div>
<div class="line">  <span class="keyword">end subroutine </span>solve</div>
<div class="line"><span class="keyword">END PROGRAM </span>linear_eigensystem_example</div>
<div class="ttc" id="ainterfaceiterative__solver_1_1mpi__init_html"><div class="ttname"><a href="interfaceiterative__solver_1_1mpi__init.html">iterative_solver::mpi_init</a></div><div class="ttdef"><b>Definition:</b> IterativeSolverF.F90:54</div></div>
<div class="ttc" id="ainterfaceiterative__solver_1_1mpi__rank__global_html"><div class="ttname"><a href="interfaceiterative__solver_1_1mpi__rank__global.html">iterative_solver::mpi_rank_global</a></div><div class="ttdef"><b>Definition:</b> IterativeSolverF.F90:62</div></div>
<div class="ttc" id="anamespaceiterative__solver__matrix__problem_html"><div class="ttname"><a href="namespaceiterative__solver__matrix__problem.html">iterative_solver_matrix_problem</a></div><div class="ttdef"><b>Definition:</b> Iterative_Solver_Matrix_Problem.F90:1</div></div>
<div class="ttc" id="anamespaceiterative__solver_html"><div class="ttname"><a href="namespaceiterative__solver.html">iterative_solver</a></div><div class="ttdoc">IterativeSolver Fortran binding.</div><div class="ttdef"><b>Definition:</b> IterativeSolverF.F90:2</div></div>
<div class="ttc" id="astructiterative__solver__matrix__problem_1_1matrix__problem_html"><div class="ttname"><a href="structiterative__solver__matrix__problem_1_1matrix__problem.html">iterative_solver_matrix_problem::matrix_problem</a></div><div class="ttdoc">A specialisation of the Problem class for linear problems in which the kernel matrix is stored in ful...</div><div class="ttdef"><b>Definition:</b> Iterative_Solver_Matrix_Problem.F90:5</div></div>
</div><!-- fragment --><p> Example including use of P space: </p><div class="fragment"></div><!-- fragment --> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nq</td><td>dimension of matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nroot</td><td>number of eigensolutions desired </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>Convergence threshold </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh_value</td><td>Value convergence threshold </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hermitian</td><td>Whether the underlying kernel is hermitian </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>Print level One gives a single progress-report line each iteration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pname</td><td>Profiler object name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>MPI communicator </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algorithm</td><td>algorithm, eg Davidson </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">range</td><td>distributed array local range start and end indices </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>key1=value1, key2=value1,... to specify arbitrary options </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a69c4bfefb260bc5df5c34a84a24a3138" name="a69c4bfefb260bc5df5c34a84a24a3138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c4bfefb260bc5df5c34a84a24a3138">&#9670;&nbsp;</a></span>iterative_solver_linear_equations_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::iterative_solver_linear_equations_initialize </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nroot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(nq, nroot), intent(in)&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>augmented_hessian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>hermitian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>pname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Finds the solutions of linear equation systems using a generalisation of Davidson's method, i.e. preconditioned Lanczos Example of simplest use: </p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">module</span> mod_linear_problem</div>
<div class="line">  <span class="keywordtype">use </span><a class="code hl_namespace" href="namespaceiterative__solver__problem.html">iterative_solver_problem</a>, <span class="keywordtype">only</span> : <a class="code hl_struct" href="structiterative__solver__problem_1_1problem.html">problem</a></div>
<div class="line">  <span class="keywordtype">DOUBLE PRECISION</span>, <span class="keywordtype">PARAMETER</span> :: alpha = 300</div>
<div class="line">  <span class="keyword">type</span>, <span class="keyword">extends</span>(<a class="code hl_struct" href="structiterative__solver__problem_1_1problem.html">problem</a>) :: linear_problem</div>
<div class="line">    <span class="keywordtype">integer</span> :: n, nroot</div>
<div class="line">  <span class="keyword">contains</span></div>
<div class="line">    <span class="keywordtype">procedure</span>, pass :: action</div>
<div class="line">    <span class="keywordtype">procedure</span>, pass :: RHS</div>
<div class="line">    <span class="keywordtype">procedure</span>, pass :: diagonals</div>
<div class="line">  <span class="keyword">end type </span>linear_problem</div>
<div class="line"><span class="keyword">contains</span></div>
<div class="line">  <span class="keyword">subroutine </span>action(this, parameters, actions, range)</div>
<div class="line">    <span class="keywordtype">class</span>(linear_problem), <span class="keywordtype">intent(in)</span> :: this</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:, :)</span> :: parameters</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:, :)</span> :: actions</div>
<div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(2)</span>, <span class="keywordtype">intent(in)</span> :: range</div>
<div class="line">    <span class="keywordtype">integer</span> :: i, j, k</div>
<div class="line">    <span class="keywordflow">do</span> k = lbound(parameters, 2), ubound(parameters, 2)</div>
<div class="line">      <span class="keywordflow">do</span> i = range(1) + 1, range(2)</div>
<div class="line">        actions(i, k) = alpha * i * parameters(i, k)</div>
<div class="line">        <span class="keywordflow">do</span> j = 1, this%n</div>
<div class="line">          actions(i, k) = actions(i, k) + dble(i + j - 2) * parameters(j, k)</div>
<div class="line"><span class="keywordflow">        end do</span></div>
<div class="line"><span class="keywordflow">      end do</span></div>
<div class="line"><span class="keywordflow">    end do</span></div>
<div class="line">  <span class="keyword">end subroutine </span>action</div>
<div class="line">  <span class="keyword">logical </span><span class="keyword">function </span>diagonals(this, d)</div>
<div class="line">    <span class="keywordtype">class</span>(linear_problem), <span class="keywordtype">intent(in)</span> :: this</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:)</span> :: d</div>
<div class="line">    <span class="keywordtype">integer</span> :: i</div>
<div class="line">    <span class="keywordflow">do</span> i = 1, this%n</div>
<div class="line">      d(i) = alpha * i + 2 * i - 2</div>
<div class="line"><span class="keywordflow">    end do</span></div>
<div class="line">    diagonals = .true.</div>
<div class="line">  <span class="keyword">end function </span>diagonals</div>
<div class="line">  <span class="keyword">logical </span><span class="keyword">function </span>rhs(this, vector, instance, range)</div>
<div class="line">    <span class="keywordtype">class</span>(linear_problem), <span class="keywordtype">intent(in)</span> :: this</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:)</span> :: vector</div>
<div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">intent(in)</span> :: instance</div>
<div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(2)</span>, <span class="keywordtype">intent(in)</span> :: range</div>
<div class="line">    <span class="keywordtype">integer</span> :: i</div>
<div class="line">    rhs = .false.</div>
<div class="line">    <span class="keywordflow">if</span> (instance.lt.1 .or. instance.gt.this%nroot) <span class="keywordflow">return</span></div>
<div class="line">    rhs = .true.</div>
<div class="line">    <span class="keywordflow">do</span> i = range(1) + 1, range(2)</div>
<div class="line">      vector(i) = 1 / dble(i + instance - 1)</div>
<div class="line"><span class="keywordflow">    end do</span></div>
<div class="line">  <span class="keyword">end function </span>rhs</div>
<div class="line"><span class="keyword">end module </span>mod_linear_problem</div>
<div class="line"> </div>
<div class="line"><span class="keyword">PROGRAM</span> linear_equations_example</div>
<div class="line">  <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespaceiterative__solver.html">iterative_solver</a></div>
<div class="line">  <span class="keywordtype">USE </span>mod_linear_problem, <span class="keywordtype">only</span> : linear_problem</div>
<div class="line">  <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line">  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: n = 30, nroot = 2</div>
<div class="line">  <span class="keywordtype">DOUBLE PRECISION</span>, <span class="keywordtype">DIMENSION (n, nroot)</span> :: c, g</div>
<div class="line">  <span class="keywordtype">TYPE</span>(linear_problem) :: problem</div>
<div class="line">  <span class="keyword">call </span><a class="code hl_interface" href="interfaceiterative__solver_1_1mpi__init.html">mpi_init</a></div>
<div class="line">  <span class="keywordflow">IF</span> (<a class="code hl_interface" href="interfaceiterative__solver_1_1mpi__rank__global.html">mpi_rank_global</a>() .gt. 0) <span class="keyword">close</span>(6)</div>
<div class="line">  print *, <span class="stringliteral">&#39;Fortran binding of IterativeSolver&#39;</span></div>
<div class="line">  problem%n = n</div>
<div class="line">  problem%nroot = nroot</div>
<div class="line">  <span class="keyword">CALL </span>solve_linear_equations(c, g, problem, thresh = 1d-11, verbosity = 2)</div>
<div class="line">  print*, <span class="stringliteral">&#39;convergence?&#39;</span>, iterative_solver_converged(), <span class="stringliteral">&#39;, residual length: &#39;</span>, norm2(g)</div>
<div class="line">  <span class="keyword">CALL </span>iterative_solver_print_statistics</div>
<div class="line">  <span class="keyword">CALL </span>iterative_solver_finalize</div>
<div class="line">  <span class="keyword">CALL </span>mpi_finalize</div>
<div class="line"><span class="keyword">END PROGRAM </span>linear_equations_example</div>
<div class="ttc" id="anamespaceiterative__solver__problem_html"><div class="ttname"><a href="namespaceiterative__solver__problem.html">iterative_solver_problem</a></div><div class="ttdef"><b>Definition:</b> Iterative_Solver_Problem.F90:1</div></div>
<div class="ttc" id="astructiterative__solver__problem_1_1problem_html"><div class="ttname"><a href="structiterative__solver__problem_1_1problem.html">iterative_solver_problem::problem</a></div><div class="ttdoc">Abstract class defining the problem-specific interface for the simplified solver interface to Iterati...</div><div class="ttdef"><b>Definition:</b> Iterative_Solver_Problem.F90:7</div></div>
</div><!-- fragment --><p> Example including use of P space: include LinearEquationsExampleF-Pspace.F90 </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nq</td><td>dimension of matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nroot</td><td>number of eigensolutions desired </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhs</td><td>the constant right-hand-side of each equation system </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">augmented_hessian</td><td>If zero, solve the inhomogeneous equations unmodified. If 1, solve instead the augmented hessian problem. Other values scale the augmented hessian damping. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>convergence threshold </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh_value</td><td>value convergence threshold </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hermitian</td><td>whether the underlying kernel is hermitian </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>how much to print. Default is zero, which prints nothing except errors. One gives a single progress-report line each iteration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pname</td><td>Profiler object name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>MPI communicator </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">range</td><td>distributed array local range start and end indices </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>key1=value1, key2=value1,... to specify arbitrary options </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7ec1c6cf65a2f9d40f2035e7ca0b77ec" name="a7ec1c6cf65a2f9d40f2035e7ca0b77ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ec1c6cf65a2f9d40f2035e7ca0b77ec">&#9670;&nbsp;</a></span>iterative_solver_optimize_initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::iterative_solver_optimize_initialize </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>minimize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>pname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Optimization through the L-BFGS or related methods. Example of simplest use: </p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="keyword">module</span> quasinewton_examples</div>
<div class="line">  <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespaceiterative__solver__problem.html">iterative_solver_problem</a></div>
<div class="line">  <span class="keywordtype">private</span></div>
<div class="line">  <span class="keyword">type</span>, <span class="keyword">extends</span>(<a class="code hl_struct" href="structiterative__solver__problem_1_1problem.html">problem</a>), <span class="keywordtype">public</span> :: forced_t</div>
<div class="line">    <span class="keywordtype">integer</span> :: size</div>
<div class="line">  <span class="keyword">contains</span></div>
<div class="line">    <span class="keywordtype">procedure</span>, pass :: residual =&gt; forced_residual</div>
<div class="line">    <span class="keywordtype">procedure</span>, pass :: diagonals =&gt; forced_diagonals</div>
<div class="line">  <span class="keyword">end type </span>forced_t</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">type</span>, <span class="keyword">extends</span>(<a class="code hl_struct" href="structiterative__solver__problem_1_1problem.html">problem</a>), <span class="keywordtype">public</span> :: quadratic_t</div>
<div class="line">  <span class="keyword">contains</span></div>
<div class="line">    <span class="keywordtype">procedure</span>, pass :: residual =&gt; quadratic_residual</div>
<div class="line">    <span class="keywordtype">procedure</span>, pass :: diagonals =&gt; quadratic_diagonals</div>
<div class="line">  <span class="keyword">end type </span>quadratic_t</div>
<div class="line"> </div>
<div class="line"><span class="keyword">contains</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">function </span>forced_residual(this, parameters, residuals, range) <span class="keyword">result</span>(e)</div>
<div class="line">    <span class="keywordtype">class</span>(forced_t), <span class="keywordtype">intent(in)</span> :: this</div>
<div class="line">    <span class="keywordtype">double precision</span> :: e</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:, :)</span> :: parameters</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:, :)</span> :: residuals</div>
<div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(2)</span>, <span class="keywordtype">intent(in)</span> :: range</div>
<div class="line">    <span class="keywordflow">do</span> i = range(1) + 1, range(2); residuals(i, 1) = sum(parameters(:, 1)) + (3 * i - 1) * parameters(i, 1) - 1;</div>
<div class="line"><span class="keywordflow">    enddo</span></div>
<div class="line">    e = 0.5 * dot_product(parameters(:, 1), residuals(:, 1)) - 0.5 * sum(parameters(:, 1))</div>
<div class="line">  <span class="keyword">end function </span>forced_residual</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">logical </span><span class="keyword">function </span>forced_diagonals(this, d)</div>
<div class="line">    <span class="keywordtype">class</span>(forced_t), <span class="keywordtype">intent(in)</span> :: this</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:)</span> :: d</div>
<div class="line">    d = [(3 * i, i = 1, <span class="keyword">size</span>(d))]</div>
<div class="line">    forced_diagonals = .true.</div>
<div class="line">  <span class="keyword">end function </span>forced_diagonals</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">function </span>quadratic_residual(this, parameters, residuals, range) <span class="keyword">result</span>(e)</div>
<div class="line">    <span class="keywordtype">class</span>(quadratic_t), <span class="keywordtype">intent(in)</span> :: this</div>
<div class="line">    <span class="keywordtype">double precision</span> :: e</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:, :)</span> :: parameters</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:, :)</span> :: residuals</div>
<div class="line">    <span class="keywordtype">integer</span>, <span class="keywordtype">dimension(2)</span>, <span class="keywordtype">intent(in)</span> :: range</div>
<div class="line">    <span class="keywordflow">do</span> i = range(1) + 1, range(2); residuals(i, 1) = sum(parameters(:, 1)) + (3 * i - 1) * parameters(i, 1);</div>
<div class="line"><span class="keywordflow">    enddo</span></div>
<div class="line">    e = dot_product(parameters(:, 1), residuals(:, 1)) / dot_product(parameters(:, 1), parameters(:, 1))</div>
<div class="line">    residuals = (residuals - e * parameters) / dot_product(parameters(:, 1), parameters(:, 1))</div>
<div class="line">  <span class="keyword">end function </span>quadratic_residual</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">logical </span><span class="keyword">function </span>quadratic_diagonals(this, d)</div>
<div class="line">    <span class="keywordtype">class</span>(quadratic_t), <span class="keywordtype">intent(in)</span> :: this</div>
<div class="line">    <span class="keywordtype">double precision</span>, <span class="keywordtype">intent(inout)</span>, <span class="keywordtype">dimension(:)</span> :: d</div>
<div class="line">    d = [(3 * i, i = 1, <span class="keyword">size</span>(d))]</div>
<div class="line">    quadratic_diagonals = .true.</div>
<div class="line">  <span class="keyword">end function </span>quadratic_diagonals</div>
<div class="line"> </div>
<div class="line"><span class="keyword">end module </span>quasinewton_examples</div>
<div class="line"> </div>
<div class="line"><span class="keyword">PROGRAM</span> quasinewton_example</div>
<div class="line">  <span class="keywordtype">USE </span><a class="code hl_namespace" href="namespaceiterative__solver.html">iterative_solver</a></div>
<div class="line">  <span class="keywordtype">USE </span>quasinewton_examples</div>
<div class="line">  <span class="keywordtype">IMPLICIT NONE</span></div>
<div class="line">  <span class="keywordtype">INTEGER</span>, <span class="keywordtype">PARAMETER</span> :: n = 100, verbosity = 2</div>
<div class="line">  <span class="keywordtype">DOUBLE PRECISION</span>, <span class="keywordtype">DIMENSION (n)</span> :: c, g</div>
<div class="line">  <span class="comment">! try one of the following</span></div>
<div class="line">  <span class="comment">!      type(quadratic_t) :: problem</span></div>
<div class="line">  <span class="keywordtype">type</span>(forced_t) :: problem</div>
<div class="line">  <span class="keyword">call </span><a class="code hl_interface" href="interfaceiterative__solver_1_1mpi__init.html">mpi_init</a></div>
<div class="line">  <span class="keyword">call </span>&amp;</div>
<div class="line">      <span class="comment">! try one of the following</span></div>
<div class="line">      solve_optimization(&amp;</div>
<div class="line">          <span class="comment">!      Solve_Nonlinear_Equations(&amp;</span></div>
<div class="line">          c, g, problem, n, thresh = 1d-6, verbosity = verbosity)</div>
<div class="line">  <span class="keywordflow">if</span> (verbosity.lt.1) <span class="keywordflow">then</span></div>
<div class="line">    print *, <span class="stringliteral">&#39;Optimized function value &#39;</span>, iterative_solver_value()</div>
<div class="line">    print *, <span class="stringliteral">&#39;Error &#39;</span>, iterative_solver_errors(), iterative_solver_converged()</div>
<div class="line"><span class="keywordflow">  end if</span></div>
<div class="line">  <span class="keywordflow">if</span> (verbosity.gt.1) <span class="keywordflow">then</span></div>
<div class="line">    <span class="keyword">call </span>iterative_solver_solution([1], c, g)</div>
<div class="line">    print *, <span class="stringliteral">&#39;solution &#39;</span>, c(1:min(n, 10))</div>
<div class="line">    print *, <span class="stringliteral">&#39;residual &#39;</span>, g(1:min(n, 10))</div>
<div class="line"><span class="keywordflow">  end if</span></div>
<div class="line">  <span class="keyword">CALL </span>iterative_solver_finalize</div>
<div class="line">  <span class="keyword">call </span>mpi_finalize</div>
<div class="line"><span class="keyword">END PROGRAM </span>quasinewton_example</div>
</div><!-- fragment --> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nq</td><td>dimension of parameter space </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>convergence threshold </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>how much to print. Default is zero, which prints nothing except errors. One gives a single progress-report line each iteration. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minimize</td><td>whether to minimize (default) or maximize </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pname</td><td>Profiler object name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>MPI communicator </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">algorithm</td><td>keyword specifying optimization algorithm </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">range</td><td>distributed array local range start and end indices </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh_value</td><td>convergence threshold for function value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>key1=value1, key2=value1,... to specify arbitrary options </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2174400663d4e6e433bf197150e423ce" name="a2174400663d4e6e433bf197150e423ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2174400663d4e6e433bf197150e423ce">&#9670;&nbsp;</a></span>iterative_solver_range()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, dimension(2) iterative_solver::iterative_solver_range</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a03f7586355d8dab8557e6cde9fc0078b" name="a03f7586355d8dab8557e6cde9fc0078b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03f7586355d8dab8557e6cde9fc0078b">&#9670;&nbsp;</a></span>iterative_solver_solution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::iterative_solver_solution </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>roots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>synchronize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the current solution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">roots</td><td>Array containing root indices </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">parameters</td><td>On exit, the solutions corresponding to roots. The second dimension must be at least as large as size(roots). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">action</td><td>On exit, the residuals corresponding to roots. The second dimension must be at least as large as size(roots). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">synchronize</td><td>synchronize Whether to synchronize any distributed storage of parameters and action before return. Unnecessary if the client preconditioner is diagonal, but otherwise should be done. The default is the safe .TRUE. but can be .FALSE. if appropriate. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeed2ec3b74a21dd29d3ab3853ace408b" name="aeed2ec3b74a21dd29d3ab3853ace408b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed2ec3b74a21dd29d3ab3853ace408b">&#9670;&nbsp;</a></span>iterative_solver_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::iterative_solver_solve </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>actions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(problem_class), intent(inout), target&#160;</td>
          <td class="paramname"><em>problem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>generate_initial_guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>max_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5165398f200e5ac77b1a80676108cc29" name="a5165398f200e5ac77b1a80676108cc29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5165398f200e5ac77b1a80676108cc29">&#9670;&nbsp;</a></span>iterative_solver_suggest_p()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function, public iterative_solver::iterative_solver_suggest_p </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>residual</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Take an existing solution and its residual, and suggest P vectors. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">solution</td><td>On input, the current solution. </td></tr>
    <tr><td class="paramname">residual</td><td>On input, the residual for solution. </td></tr>
    <tr><td class="paramname">indices</td><td>On exit, the most important base vectors </td></tr>
    <tr><td class="paramname">threshold</td><td>IterativeSolver vectors whose predicted contribution is less than than this are not considered </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of vectors suggested. </dd></dl>

</div>
</div>
<a id="a11e3d198ebd7872c9ed08cbbdf9dd012" name="a11e3d198ebd7872c9ed08cbbdf9dd012"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11e3d198ebd7872c9ed08cbbdf9dd012">&#9670;&nbsp;</a></span>iterative_solver_working_set_eigenvalues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double precision function, dimension(working_set_size), public iterative_solver::iterative_solver_working_set_eigenvalues </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>working_set_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the eigenvalues of the reduced problem, for the number of roots in working set (not yet converged). </p>

</div>
</div>
<a id="a2890fe920d167483bcac382af12afe5d" name="a2890fe920d167483bcac382af12afe5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2890fe920d167483bcac382af12afe5d">&#9670;&nbsp;</a></span>mpicomm_compute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>) function, public iterative_solver::mpicomm_compute</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a508258aa021cc2d872fba06bd1cff849" name="a508258aa021cc2d872fba06bd1cff849"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a508258aa021cc2d872fba06bd1cff849">&#9670;&nbsp;</a></span>set_mpicomm_compute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::set_mpicomm_compute </td>
          <td>(</td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in)&#160;</td>
          <td class="paramname"><em>comm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0ec8e7c839d5189981da473f64b78ade" name="a0ec8e7c839d5189981da473f64b78ade"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ec8e7c839d5189981da473f64b78ade">&#9670;&nbsp;</a></span>solve_linear_eigensystem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::solve_linear_eigensystem </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>actions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(problem_class), intent(inout), target&#160;</td>
          <td class="paramname"><em>problem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>nroot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>generate_initial_guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>max_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>hermitian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>pname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nroot</td><td>number of eigensolutions desired</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">generate_initial_guess</td><td>whether to generate an initial guess (default) or use what is passed in parameters</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_iter</td><td>maximum number of iterations</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_p</td><td>maximum dimension of generated P space</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>convergence threshold</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh_value</td><td>value convergence threshold</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hermitian</td><td>whether the underlying kernel is hermitian</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>how much to print. Default is zero, which prints nothing except errors. One gives a summary at the end; two gives a single progress-report line each iteration.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pname</td><td>Profiler object name</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>MPI communicator</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">range</td><td>distributed array local range start and end indices</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>key1=value1, key2=value1,... to specify arbitrary options </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0ce14b9eca351507039f752494a53349" name="a0ce14b9eca351507039f752494a53349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ce14b9eca351507039f752494a53349">&#9670;&nbsp;</a></span>solve_linear_equations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::solve_linear_equations </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>actions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(problem_class), intent(inout)&#160;</td>
          <td class="paramname"><em>problem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>generate_initial_guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>max_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>augmented_hessian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>hermitian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>pname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">generate_initial_guess</td><td>whether to generate an initial guess (default) or use what is passed in parameters</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_iter</td><td>maximum number of iterations</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_p</td><td>maximum dimension of generated P space</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">augmented_hessian</td><td>If zero, solve the inhomogeneous equations unmodified. If 1, solve instead the augmented hessian problem. Other values scale the augmented hessian damping.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>convergence threshold</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh_value</td><td>value convergence threshold</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hermitian</td><td>whether the underlying kernel is hermitian</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>how much to print. Default is zero, which prints nothing except errors. One gives a summary at the end; two gives a single progress-report line each iteration.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pname</td><td>Profiler object name</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>MPI communicator</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">range</td><td>distributed array local range start and end indices</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>key1=value1, key2=value1,... to specify arbitrary options </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a05c7eeda78e69ee7c484fe069ab0231b" name="a05c7eeda78e69ee7c484fe069ab0231b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05c7eeda78e69ee7c484fe069ab0231b">&#9670;&nbsp;</a></span>solve_nonlinear_equations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::solve_nonlinear_equations </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>actions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(problem_class), intent(inout), target&#160;</td>
          <td class="paramname"><em>problem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>nroot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>generate_initial_guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>hermitian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>pname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nroot</td><td>number of eigensolutions desired</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">generate_initial_guess</td><td>whether to generate an initial guess (default) or use what is passed in parameters</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_iter</td><td>maximum number of iterations</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>convergence threshold</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hermitian</td><td>whether the underlying kernel is hermitian</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>how much to print. Default is zero, which prints nothing except errors. One gives a summary at the end; two gives a single progress-report line each iteration.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pname</td><td>Profiler object name</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>MPI communicator</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">range</td><td>distributed array local range start and end indices</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>key1=value1, key2=value1,... to specify arbitrary options </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aafc0c445dbb353da38c92aa1ce4640f2" name="aafc0c445dbb353da38c92aa1ce4640f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafc0c445dbb353da38c92aa1ce4640f2">&#9670;&nbsp;</a></span>solve_optimization()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public iterative_solver::solve_optimization </td>
          <td>(</td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, dimension(..), intent(inout), target&#160;</td>
          <td class="paramname"><em>actions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(problem_class), intent(inout), target&#160;</td>
          <td class="paramname"><em>problem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>nroot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>generate_initial_guess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>max_iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double precision, intent(in), optional&#160;</td>
          <td class="paramname"><em>thresh_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>hermitian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>verbosity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>minimize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>pname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kind = <a class="el" href="namespaceiterative__solver.html#a8e7b0afa0169579bd571c1aac764d4e8">mpicomm_kind</a>), intent(in), optional&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len = *), intent(in), optional&#160;</td>
          <td class="paramname"><em>algorithm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(2), intent(inout), optional&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(*), intent(in), optional&#160;</td>
          <td class="paramname"><em>options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nroot</td><td>number of eigensolutions desired</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">generate_initial_guess</td><td>whether to generate an initial guess (default) or use what is passed in parameters</td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_iter</td><td>maximum number of iterations</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh</td><td>convergence threshold</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thresh_value</td><td>value convergence threshold</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hermitian</td><td>whether the underlying kernel is hermitian</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbosity</td><td>how much to print. Default is zero, which prints nothing except errors. One gives a summary at the end; two gives a single progress-report line each iteration.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minimize</td><td>whether to minimize (default) or maximize</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pname</td><td>Profiler object name</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>MPI communicator</td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">range</td><td>distributed array local range start and end indices</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">options</td><td>key1=value1, key2=value1,... to specify arbitrary options </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a762cf435ede70697d8e9df140d410d27" name="a762cf435ede70697d8e9df140d410d27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a762cf435ede70697d8e9df140d410d27">&#9670;&nbsp;</a></span>test_select()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine iterative_solver::test_select</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad1ae0165bd555ba3fbf8d9c6e55d83c0" name="ad1ae0165bd555ba3fbf8d9c6e55d83c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1ae0165bd555ba3fbf8d9c6e55d83c0">&#9670;&nbsp;</a></span>current_problem</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">class(problem_class), pointer, public iterative_solver::current_problem</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a260bebdd67c530e7e08bf211bc44760b" name="a260bebdd67c530e7e08bf211bc44760b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a260bebdd67c530e7e08bf211bc44760b">&#9670;&nbsp;</a></span>iterative_solver_iterations</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, public iterative_solver::iterative_solver_iterations</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8e7b0afa0169579bd571c1aac764d4e8" name="a8e7b0afa0169579bd571c1aac764d4e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e7b0afa0169579bd571c1aac764d4e8">&#9670;&nbsp;</a></span>mpicomm_kind</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter, public iterative_solver::mpicomm_kind = KIND(c_int64_t)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceiterative__solver.html">iterative_solver</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
